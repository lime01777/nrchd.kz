import{r as c,W as h,j as e}from"./app-Be9c_AKX.js";import{A as j}from"./AdminLayout-jSpea73s.js";import"./transition-BrnEjee0.js";import"./use-is-mounted-DF_svWGF.js";function w({stats:o,languages:u,recentTranslations:m}){const[r,i]=c.useState(!1),[l,n]=c.useState(null),{data:d,setData:x,post:b,processing:p}=h({target_language:"en"}),g=async()=>{if(!r){i(!0),n({message:"Начинаем массовый перевод...",progress:0});try{const s=await(await fetch(route("admin.translations.translate-all"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({target_language:d.target_language})})).json();s.success?(n({message:"Перевод завершен!",progress:100,stats:s.stats}),setTimeout(()=>{window.location.reload()},3e3)):n({message:"Ошибка: "+s.message,progress:0,error:!0})}catch(t){console.error("Ошибка перевода:",t),n({message:"Произошла ошибка при переводе",progress:0,error:!0})}finally{i(!1)}}};return e.jsx(j,{children:e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Управление переводами"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:Object.entries(o).map(([t,s])=>e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Язык: ",t==="en"?"English":"Қазақша"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Всего переводов:"}),e.jsx("span",{className:"font-semibold",children:s.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Проверенных:"}),e.jsx("span",{className:"font-semibold text-green-600",children:s.verified})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Процент проверенных:"}),e.jsxs("span",{className:"font-semibold",children:[s.total>0?Math.round(s.verified/s.total*100):0,"%"]})]})]})]},t))}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Массовый перевод контента"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Эта функция просканирует весь контент сайта и переведет новые тексты, которые еще не переведены."}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Целевой язык:"}),e.jsxs("select",{value:d.target_language,onChange:t=>x("target_language",t.target.value),className:"mt-1 block w-48 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",disabled:r,children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"kz",children:"Қазақша"})]})]}),e.jsx("button",{onClick:g,disabled:r,className:`px-6 py-3 rounded-md font-medium ${r?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:r?"Переводим...":"Запустить массовый перевод"}),l&&e.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:[e.jsx("div",{className:`text-sm ${l.error?"text-red-600":"text-blue-600"}`,children:l.message}),l.progress>0&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.progress}%`}})})}),l.stats&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:[e.jsxs("div",{children:["Всего найдено текстов: ",l.stats.total_found]}),e.jsxs("div",{children:["Уже переведено: ",l.stats.already_translated]}),e.jsxs("div",{children:["Новых переводов: ",l.stats.newly_translated]}),l.stats.errors>0&&e.jsxs("div",{className:"text-red-600",children:["Ошибок: ",l.stats.errors]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Последние переводы"}),Object.entries(m).map(([t,s])=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium mb-3",children:[t==="en"?"English":"Қазақша",e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",s.length," переводов)"]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg max-h-96 overflow-y-auto",children:s.slice(0,10).map(a=>e.jsxs("div",{className:"p-3 border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:[e.jsx("strong",{children:"Оригинал:"})," ",a.original_text.substring(0,100),a.original_text.length>100&&"..."]}),e.jsxs("div",{className:"text-sm text-gray-800",children:[e.jsx("strong",{children:"Перевод:"})," ",a.translated_text.substring(0,100),a.translated_text.length>100&&"..."]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[new Date(a.created_at).toLocaleString("ru-RU"),a.is_verified&&e.jsx("span",{className:"ml-2 text-green-600",children:"✓ Проверено"})]})]},a.id))})]},t))]}),e.jsxs("div",{className:"bg-yellow-50 p-6 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Как это работает:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-700",children:[e.jsx("li",{children:"Система сканирует весь контент сайта (новости, категории, статические тексты)"}),e.jsx("li",{children:"Проверяет, какие тексты уже переведены"}),e.jsx("li",{children:"Новые тексты автоматически переводятся через Google Translate"}),e.jsx("li",{children:"Все переводы сохраняются в базе данных для быстрого доступа"}),e.jsx("li",{children:"При переключении языка переводы загружаются мгновенно из БД"})]})]})]})})})})})}export{w as default};
