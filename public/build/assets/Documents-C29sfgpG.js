import{r as d,j as e,b as w,Y}from"./app-BQ3qogJL.js";import{L as F}from"./LayoutFolderChlank-CEWLTCUV.js";import{t as f}from"./TranslationService-6o6muFbl.js";import{f as A,C as B,b as P,L as $,B as E,c as L,d as k,e as z,p as R,a as M,i as _}from"./index-CW3Olatm.js";import{S as U}from"./SimpleFileDisplay-BnBVjmOr.js";import"./Footer-Dh48A233.js";B.register(P,$,E,L,k,z,R,M,_);const o=(t,c="")=>f.t(t,c);function H({folder:t="",title:c=""}){const[r,y]=d.useState(""),[g,j]=d.useState({}),u=d.useMemo(()=>{const s=[];for(let a=2010;a<=2024;a++)s.push(a.toString());return s},[]),v=d.useMemo(()=>{if(!t)return"";const s=t.replace(/\\/g,"/");return r?`${s.replace(/\/$/,"")}/${r}`:s},[t,r]);d.useEffect(()=>{(async()=>{if(t)try{const a=window.location.origin,N=t.replace(/\\/g,"/").replace(/\/$/,""),x={},S=u.map(async l=>{try{const i=new URLSearchParams;i.append("folder",`${N}/${l}`);const n=await w.get(`${a}/api/files?${i.toString()}`);let m=0;return Array.isArray(n.data)?n.data.forEach(p=>{p.files&&(m+=p.files.length),p.documents&&(m+=p.documents.length)}):n.data&&n.data.files?m=n.data.files.length:n.data&&Array.isArray(n.data.documents)&&(m=n.data.documents.length),{year:l,count:m}}catch(i){return console.warn(`Не удалось загрузить данные для года ${l}:`,i),{year:l,count:0}}});(await Promise.all(S)).forEach(({year:l,count:i})=>{x[l]=i}),j(x)}catch(a){console.error("Ошибка при загрузке статистики по годам:",a)}})()},[t,u]);const C=d.useMemo(()=>{const s=u,a=s.map(b=>g[b]||0);return{labels:s,datasets:[{label:"Количество документов",data:a,backgroundColor:"rgba(59, 130, 246, 0.5)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0}]}},[g,u]),D={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}};return e.jsxs("div",{className:"space-y-6",children:[c&&e.jsx("div",{className:"mb-6",children:e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:c})}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:o("components.documentsDashboard.filterByYear","Фильтр по году")}),e.jsxs("select",{value:r,onChange:s=>y(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:o("components.documentsDashboard.allYears","Выберите год")}),u.map(s=>e.jsx("option",{value:s,children:s},s))]})]})}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:r?e.jsxs("span",{children:[o("components.documentsDashboard.showingDocumentsFor","Показаны документы за")," ",r," ",o("components.documentsDashboard.year","год"),g[r]!==void 0&&e.jsxs("span",{className:"ml-2",children:["(",g[r]," ",o("components.documentsDashboard.documents","документов"),")"]})]}):e.jsx("span",{children:o("components.documentsDashboard.selectYear","Выберите год для просмотра документов")})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:o("components.documentsDashboard.documentsByYear","Документы по годам")}),e.jsx("div",{className:"h-64",children:e.jsx(A,{data:C,options:D})})]})}),r?e.jsx("div",{children:e.jsx(U,{folder:v,title:o("components.documentsDashboard.documentsForYear","Документы за {year} год"),bgColor:"bg-gray-50",hideDownload:!1})}):e.jsx("div",{className:"bg-gray-50 p-8 rounded-lg text-center text-gray-500",children:e.jsx("p",{children:o("components.documentsDashboard.selectYearToView","Выберите год из списка выше для просмотра документов")})})]})}const h=(t,c="")=>f.t(t,c);function O(){return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:h("directionsPages.healthAccountsSubpages.documents.title","Документы")}),e.jsx("div",{className:"container px-5 mx-auto py-8",children:e.jsx(H,{folder:h("directionsPages.healthAccountsSubpages.documents.folder","Национальные счета/Документы"),title:h("directionsPages.healthAccountsSubpages.documents.title","Отчётность по Национальным счетам здравоохранения")})})]})}O.layout=t=>e.jsx(F,{h1:h("directionsPages.healthAccountsSubpages.documents.h1","Документы"),parentRoute:route("health.accounts"),parentName:h("directionsPages.healthAccountsSubpages.documents.parentName","Национальные счета здравоохранения"),bgColor:"bg-white",heroBgColor:"bg-gray-200",buttonBgColor:"bg-gray-200",buttonHoverBgColor:"hover:bg-gray-300",buttonBorderColor:"border-gray-300",children:t});export{O as default};
