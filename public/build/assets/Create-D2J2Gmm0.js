import{W as k,r as o,j as e,a as D}from"./app-CgHP3yWp.js";import{A}from"./AdminLayout-DX9nb-5k.js";import{S as F}from"./react-select.esm-F0tRVJE3.js";import{I,R as E}from"./quill.snow-DdwWOwSy.js";import"./transition-5RI6Uazs.js";const R=["Общие","Аккредитация","Обучение","Конференции","Методические материалы","Исследования","Анонсы"];function L(){const{data:s,setData:a,post:b,processing:m,errors:l}=k({title:"",category:[],content:"",images:[],main_image:null,status:"Черновик",publishDate:new Date().toISOString().substr(0,10)}),[i,f]=o.useState(R),[d,u]=o.useState([]),[n,x]=o.useState(""),[h,j]=o.useState([]),[g,y]=o.useState(null),p=i.map(t=>({value:t,label:t})),N=t=>{const r=t?t.map(c=>c.value):[];u(r),a("category",r)},v=()=>{if(n&&!i.includes(n)){f([...i,n]);const t=[...d,n];u(t),a("category",t),x("")}},w=t=>{t.preventDefault();const r=Array.isArray(s.category)?s.category:[s.category].filter(Boolean);if(r.forEach((c,S)=>a(`category[${S}]`,c)),typeof s.content!="string"&&a("content",String(s.content||"")),["Черновик","Опубликовано","Запланировано"].includes(s.status)||a("status","Черновик"),a("images",h),a("main_image",g),!s.content||s.content.replace(/<(.|\n)*?>/g,"").trim().length<10){alert("Содержимое должно содержать минимум 10 символов");return}if(r.length===0){alert("Выберите хотя бы одну категорию");return}b(route("admin.news.store"),{forceFormData:!0})},C=t=>{a("content",t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Создание новости"}),e.jsxs(D,{href:route("admin.news"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Назад к списку"]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-6",children:[e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Заголовок *"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"text",name:"title",id:"title",value:s.title,onChange:t=>a("title",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,placeholder:"Введите заголовок новости"})}),l.title&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.title})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Категории *"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center mb-2",children:[e.jsx("div",{className:"w-full sm:w-2/3",children:e.jsx(F,{isMulti:!0,options:p,value:p.filter(t=>d.includes(t.value)),onChange:N,classNamePrefix:"react-select",placeholder:"Выберите категории...",styles:{control:t=>({...t,minHeight:"42px",borderRadius:"8px",borderColor:"#cbd5e1",boxShadow:"none"}),multiValue:t=>({...t,background:"#e0e7ff",color:"#3730a3"}),option:(t,r)=>({...t,background:r.isFocused?"#f3f4f6":"white",color:"#1e293b"})}})}),e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-auto",children:[e.jsx("input",{type:"text",value:n,onChange:t=>x(t.target.value),placeholder:"Новая категория",className:"border rounded px-2 py-1 text-sm"}),e.jsx("button",{type:"button",onClick:v,className:"px-2 py-1 bg-blue-500 text-white rounded text-sm",children:"Добавить"})]})]}),l.category&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.category})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Статус *"}),e.jsx("div",{className:"mt-1",children:e.jsxs("select",{id:"status",name:"status",value:s.status,onChange:t=>a("status",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"Черновик",children:"Черновик"}),e.jsx("option",{value:"Опубликовано",children:"Опубликовано"}),e.jsx("option",{value:"Запланировано",children:"Запланировано"})]})}),l.status&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.status})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"publishDate",className:"block text-sm font-medium text-gray-700",children:"Дата публикации"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"date",name:"publishDate",id:"publishDate",value:s.publishDate,onChange:t=>a("publishDate",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"})}),l.publishDate&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.publishDate})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Галерея изображений (до 18)"}),e.jsx(I,{images:h,setImages:j,mainImage:g,setMainImage:y,max:18})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Содержимое *"}),e.jsx("div",{className:"bg-white border-2 border-blue-200 rounded-lg shadow-sm p-2 min-h-[220px] focus-within:ring-2 focus-within:ring-blue-400 transition-all",children:e.jsx(E,{value:s.content,onChange:C,theme:"snow",placeholder:"Введите текст новости...",className:"min-h-[180px]"})}),l.content&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.content}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Минимум 10 символов"})]})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:m,children:m?"Создание...":"Создать новость"})})]})})]})}L.layout=s=>e.jsx(A,{title:"Создание новости",children:s});export{L as default};
