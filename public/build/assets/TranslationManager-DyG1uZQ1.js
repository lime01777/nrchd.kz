import{R as m,r as g,j as t,Y as E}from"./app-DnhaIhTc.js";import{A as M}from"./AdminLayout-AiZASiqq.js";import"./transition-DZ8pWdwp.js";var S={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},O=m.createContext&&m.createContext(S),T=["attr","size","title"];function H(e,s){if(e==null)return{};var r=k(e,s),a,c;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(c=0;c<o.length;c++)a=o[c],!(s.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function k(e,s){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(s.indexOf(a)>=0)continue;r[a]=e[a]}return r}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b.apply(this,arguments)}function z(e,s){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);s&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,a)}return r}function j(e){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?z(Object(r),!0).forEach(function(a){L(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function L(e,s,r){return s=R(s),s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function R(e){var s=V(e,"string");return typeof s=="symbol"?s:s+""}function V(e,s){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,s||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(e)}function C(e){return e&&e.map((s,r)=>m.createElement(s.tag,j({key:r},s.attr),C(s.child)))}function f(e){return s=>m.createElement(_,b({attr:j({},e.attr)},s),C(e.child))}function _(e){var s=r=>{var{attr:a,size:c,title:o}=e,u=H(e,T),l=c||r.size||"1em",d;return r.className&&(d=r.className),e.className&&(d=(d?d+" ":"")+e.className),m.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,u,{className:d,style:j(j({color:e.color||r.color},r.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&m.createElement("title",null,o),e.children)};return O!==void 0?m.createElement(O.Consumer,null,r=>s(r)):s(S)}function D(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"},child:[]}]})(e)}function U(e){return f({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function A(e){return f({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"},child:[]}]})(e)}function F(e){return f({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M152.1 236.2c-3.5-12.1-7.8-33.2-7.8-33.2h-.5s-4.3 21.1-7.8 33.2l-11.1 37.5H163zM616 96H336v320h280c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24zm-24 120c0 6.6-5.4 12-12 12h-11.4c-6.9 23.6-21.7 47.4-42.7 69.9 8.4 6.4 17.1 12.5 26.1 18 5.5 3.4 7.3 10.5 4.1 16.2l-7.9 13.9c-3.4 5.9-10.9 7.8-16.7 4.3-12.6-7.8-24.5-16.1-35.4-24.9-10.9 8.7-22.7 17.1-35.4 24.9-5.8 3.5-13.3 1.6-16.7-4.3l-7.9-13.9c-3.2-5.6-1.4-12.8 4.2-16.2 9.3-5.7 18-11.7 26.1-18-7.9-8.4-14.9-17-21-25.7-4-5.7-2.2-13.6 3.7-17.1l6.5-3.9 7.3-4.3c5.4-3.2 12.4-1.7 16 3.4 5 7 10.8 14 17.4 20.9 13.5-14.2 23.8-28.9 30-43.2H412c-6.6 0-12-5.4-12-12v-16c0-6.6 5.4-12 12-12h64v-16c0-6.6 5.4-12 12-12h16c6.6 0 12 5.4 12 12v16h64c6.6 0 12 5.4 12 12zM0 120v272c0 13.3 10.7 24 24 24h280V96H24c-13.3 0-24 10.7-24 24zm58.9 216.1L116.4 167c1.7-4.9 6.2-8.1 11.4-8.1h32.5c5.1 0 9.7 3.3 11.4 8.1l57.5 169.1c2.6 7.8-3.1 15.9-11.4 15.9h-22.9a12 12 0 0 1-11.5-8.6l-9.4-31.9h-60.2l-9.1 31.8c-1.5 5.1-6.2 8.7-11.5 8.7H70.3c-8.2 0-14-8.1-11.4-15.9z"},child:[]}]})(e)}function B(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"},child:[]}]})(e)}function G(){const[e,s]=g.useState(!1),[r,a]=g.useState({ru:{count:0,lastUpdated:null},kz:{count:0,lastUpdated:null},en:{count:0,lastUpdated:null}}),[c,o]=g.useState("en"),[u,l]=g.useState(""),[d,w]=g.useState(0);g.useEffect(()=>{v()},[]);const v=async()=>{try{const i=await(await fetch("/api/admin/translations/stats")).json();i.success&&a(i.stats)}catch(n){console.error("Ошибка при получении статистики переводов:",n)}},P=async()=>{if(confirm(`Вы точно хотите запустить перевод всего сайта на ${c}? Это может занять некоторое время.`)){s(!0),l("Инициализация перевода..."),w(0);try{const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),h=await(await fetch("/api/admin/translations/site-urls")).json();if(!h.success||!h.urls||h.urls.length===0)throw new Error("Не удалось получить список URL для перевода");const x=h.urls.length;let p=0;for(const y of h.urls){l(`Перевод контента: ${y} (${p+1}/${x})`);const N=await(await fetch("/api/admin/translations/translate-page",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({url:y,target_language:c})})).json();N.success||console.warn(`Предупреждение при переводе ${y}:`,N.message),p++,w(Math.round(p/x*100))}await v(),l(`Перевод завершен! Переведено ${p} страниц на ${c}`)}catch(n){console.error("Ошибка при переводе:",n),l(`Ошибка: ${n.message}`)}finally{s(!1)}}},$=async n=>{if(confirm(`Вы уверены, что хотите удалить все переводы для языка ${n}?`))try{s(!0),l(`Удаление переводов для ${n}...`);const i=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),x=await(await fetch("/api/admin/translations/clear",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":i},body:JSON.stringify({language:n})})).json();x.success?(l(`Переводы для ${n} удалены. Удалено ${x.deleted_count} записей.`),await v()):l(`Ошибка при удалении переводов: ${x.message}`)}catch(i){console.error("Ошибка при удалении переводов:",i),l(`Ошибка: ${i.message}`)}finally{s(!1)}};return t.jsxs(M,{children:[t.jsx(E,{title:"Управление переводами сайта"}),t.jsx("div",{className:"py-12",children:t.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("h2",{className:"text-2xl font-semibold mb-6 flex items-center",children:[t.jsx(A,{className:"mr-2 text-indigo-600"}),"Управление переводами сайта"]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[t.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center",children:[t.jsx(D,{className:"mr-2 text-indigo-500"}),"Статистика переводов в базе данных"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(r).map(([n,i])=>t.jsxs("div",{className:"bg-white p-4 rounded-md shadow border",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"font-medium text-gray-700",children:n==="ru"?"Русский":n==="kz"?"Казахский":"Английский"}),t.jsx("span",{className:`px-2 py-1 rounded text-xs ${n==="ru"?"bg-red-100 text-red-800":n==="kz"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.toUpperCase()})]}),t.jsxs("div",{className:"text-2xl font-bold mb-2",children:[i.count," ",t.jsx("span",{className:"text-sm font-normal text-gray-500",children:"переводов"})]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["Последнее обновление: ",i.lastUpdated?new Date(i.lastUpdated).toLocaleString():"Никогда"]}),t.jsx("div",{className:"mt-3",children:t.jsx("button",{onClick:()=>$(n),className:"px-3 py-1 text-xs bg-red-50 text-red-600 rounded hover:bg-red-100 transition",disabled:e||i.count===0,children:"Очистить"})})]},n))})]}),t.jsxs("div",{className:"bg-indigo-50 p-6 rounded-lg",children:[t.jsxs("h3",{className:"text-lg font-medium mb-4 flex items-center",children:[t.jsx(F,{className:"mr-2 text-indigo-600"}),"Запуск перевода сайта"]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выберите язык перевода:"}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsxs("button",{onClick:()=>o("ru"),className:`px-4 py-2 rounded-md flex items-center ${c==="ru"?"bg-red-600 text-white":"bg-white text-gray-700 border"}`,children:[t.jsx("span",{className:"mr-1",children:"🇷🇺"})," Русский"]}),t.jsxs("button",{onClick:()=>o("kz"),className:`px-4 py-2 rounded-md flex items-center ${c==="kz"?"bg-blue-600 text-white":"bg-white text-gray-700 border"}`,children:[t.jsx("span",{className:"mr-1",children:"🇰🇿"})," Казахский"]}),t.jsxs("button",{onClick:()=>o("en"),className:`px-4 py-2 rounded-md flex items-center ${c==="en"?"bg-green-600 text-white":"bg-white text-gray-700 border"}`,children:[t.jsx("span",{className:"mr-1",children:"🇬🇧"})," Английский"]})]})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("button",{onClick:P,disabled:e,className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition disabled:opacity-50",children:[e?t.jsx(B,{className:"animate-spin mr-2"}):t.jsx(U,{className:"mr-2"}),e?"Перевод в процессе...":"Запустить перевод сайта"]})}),e&&t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"mb-2 flex justify-between text-sm",children:[t.jsx("span",{children:u}),t.jsxs("span",{children:[d,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${d}%`}})})]}),!e&&u&&t.jsx("div",{className:`mt-4 p-3 rounded ${u.includes("Ошибка")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:u})]})]})})})})]})}export{G as default};
