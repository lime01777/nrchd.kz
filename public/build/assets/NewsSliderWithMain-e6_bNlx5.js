import{r as n,R as L,j as e}from"./app-6k9bwpyy.js";function k({images:o=[],className:c="",height:d="160px",showDots:p=!0,showCounter:j=!1,autoPlay:b=!0,interval:v=3e3}){const[a,u]=n.useState(0),[i,h]=n.useState(new Set),[w,y]=n.useState(new Set),[g,m]=n.useState(!0),s=L.useMemo(()=>{if(!Array.isArray(o)||o.length===0)return[];const t=o.filter(r=>r&&(typeof r=="string"||r instanceof File));return console.log("NewsSliderWithMain - обработка изображений:",{images:o,validImages:t,imagesLength:o.length,validLength:t.length}),t},[o]),x=n.useCallback(t=>{h(r=>{const l=new Set(r);return l.add(t),l.size>=s.length&&m(!1),l})},[s.length]),f=n.useCallback(t=>{y(r=>{const l=new Set(r);return l.add(t),l}),h(r=>{const l=new Set(r);return l.add(t),l.size>=s.length&&m(!1),l})},[s.length]);if(n.useEffect(()=>{h(new Set),y(new Set),m(!1),u(0)},[s]),n.useEffect(()=>{if(!b||s.length<=1||!i.has(0))return;const t=setInterval(()=>{u(r=>(r+1)%s.length)},v);return()=>clearInterval(t)},[s.length,b,v,i]),!Array.isArray(s)||s.length===0)return e.jsx("div",{className:`relative overflow-hidden rounded-lg bg-gray-200 flex items-center justify-center ${c}`,style:{height:d},children:e.jsxs("div",{className:"text-gray-400 text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm",children:"Нет изображений"})]})});if(s.length===1)return e.jsxs("div",{className:`relative overflow-hidden rounded-lg ${c}`,style:{height:d},children:[g&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 flex items-center justify-center z-10",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),e.jsx("img",{src:s[0],alt:"Изображение новости",className:`w-full h-full object-cover transition-opacity duration-300 ${i.has(0)?"opacity-100":"opacity-0"}`,onLoad:()=>x(0),onError:t=>{console.error("Ошибка загрузки изображения:",s[0]),f(0),t.target.onerror=null,t.target.src="/img/placeholder.jpg"}}),j&&!g&&e.jsx("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:"1 / 1"}),p&&!g&&e.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-100"})})]});const N=t=>{u(t)};return e.jsxs("div",{className:`relative overflow-hidden rounded-lg ${c}`,style:{height:d},children:[e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:s[a],alt:`Изображение ${a+1}`,className:`w-full h-full object-cover transition-opacity duration-500 ${i.has(a)?"opacity-100":"opacity-0"}`,onLoad:()=>x(a),onError:t=>{console.error("Ошибка загрузки изображения:",s[a]),f(a),t.target.onerror=null,t.target.src="/img/placeholder.jpg"}}),s.map((t,r)=>r!==a&&e.jsx("img",{src:t,alt:"",className:"hidden",onLoad:()=>x(r),onError:()=>f(r)},r)),w.has(a)&&e.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("svg",{className:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("p",{className:"text-xs",children:"Ошибка"})]})})]}),j&&s.length>1&&e.jsxs("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded z-10",children:[a+1," / ",s.length]}),p&&s.length>1&&e.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1 z-10",children:s.map((t,r)=>e.jsx("button",{onClick:()=>N(r),className:`w-2 h-2 rounded-full transition-all duration-200 ${r===a?"bg-white opacity-100":"bg-white opacity-50 hover:opacity-75"}`,"aria-label":`Перейти к изображению ${r+1}`},r))})]})}export{k as N};
