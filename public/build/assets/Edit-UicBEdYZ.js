import{r as n,W as T,j as e,Y as $,a as E}from"./app-Cg-aiRh8.js";import{A as R}from"./AdminLayout-BBGvqktT.js";import"./transition--wkYrX6_.js";import"./use-is-mounted-DKJQzBpD.js";function D({vacancy:s}){const q=t=>!t||!Array.isArray(t)?"":t.map(r=>r.type==="paragraph"&&r.data&&r.data.text?r.data.text:"").join(`

`),m=t=>!t||!Array.isArray(t)?"":t.map(r=>r.type==="paragraph"&&r.data&&r.data.text?r.data.text:"").join(`

`),[I,f]=n.useState(!1),[c,w]=n.useState(q(s.body)||""),[p,y]=n.useState(m(s.functional_responsibilities)||""),[x,j]=n.useState(m(s.qualification_requirements)||""),[b,N]=n.useState(m(s.application_procedure)||""),{data:a,setData:l,put:A,processing:_,errors:i}=T({title:s.title||"",slug:s.slug||"",excerpt:s.excerpt||"",body:Array.isArray(s.body)?s.body:[],functional_responsibilities:Array.isArray(s.functional_responsibilities)?s.functional_responsibilities:[],qualification_requirements:Array.isArray(s.qualification_requirements)?s.qualification_requirements:[],application_procedure:Array.isArray(s.application_procedure)?s.application_procedure:[],city:s.city||"",department:s.department||"",employment_type:s.employment_type||"",status:s.status||"published",published_at:s.published_at?new Date(s.published_at).toISOString().substr(0,10):""}),v=t=>{const d=t.split(`
`).filter(u=>u.trim()!=="").map(u=>({type:"paragraph",data:{text:u.trim()}}));l("body",d),w(t)},o=(t,r,d)=>{const h=t.split(`
`).filter(g=>g.trim()!=="").map(g=>({type:"paragraph",data:{text:g.trim()}}));l(r,h),d(t)};n.useEffect(()=>{a.status==="published"&&!a.published_at&&l("published_at",new Date().toISOString().substr(0,10))},[a.status]);const[B,C]=n.useState("");n.useEffect(()=>{if(s.body&&s.body.blocks){const t=s.body.blocks.map(r=>{if(r.type==="paragraph")return`<p>${r.data.text}</p>`;if(r.type==="header")return`<h${r.data.level}>${r.data.text}</h${r.data.level}>`;if(r.type==="list"){const d=r.data.style==="ordered"?"ol":"ul",u=r.data.items.map(h=>`<li>${h}</li>`).join("");return`<${d}>${u}</${d}>`}return""}).join("");C(t)}},[s]);const F=["Полная занятость","Частичная занятость","Проектная работа","Стажировка","Удаленная работа"],S=t=>{t.preventDefault(),f(!0);try{a.body.length===0&&c.trim()!==""&&v(c),a.functional_responsibilities.length===0&&p.trim()!==""&&o(p,"functional_responsibilities",y),a.qualification_requirements.length===0&&x.trim()!==""&&o(x,"qualification_requirements",j),a.application_procedure.length===0&&b.trim()!==""&&o(b,"application_procedure",N);const r=a.status==="published"&&!a.published_at?new Date().toISOString().substr(0,10):a.published_at;A(route("vacancies.update",s.id),{...a,published_at:r})}catch(r){console.error("Ошибка при отправке формы:",r),f(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx($,{title:"Редактирование вакансии"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsxs("div",{className:"mb-6 flex justify-between",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["Редактирование вакансии: ",s.title]}),e.jsx(E,{href:route("vacancies.index"),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Назад к списку"})]}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Название *"}),e.jsx("input",{type:"text",id:"title",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.title,onChange:t=>l("title",t.target.value),required:!0}),i.title&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.title})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 mb-1",children:"URL slug (опционально)"}),e.jsx("input",{type:"text",id:"slug",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.slug,onChange:t=>l("slug",t.target.value),placeholder:"Оставьте пустым для автоматической генерации"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Если оставить пустым, slug будет сгенерирован автоматически из названия"}),i.slug&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.slug})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"excerpt",className:"block text-sm font-medium text-gray-700 mb-1",children:"Краткое описание"}),e.jsx("textarea",{id:"excerpt",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",rows:"3",value:a.excerpt,onChange:t=>l("excerpt",t.target.value)}),i.excerpt&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.excerpt})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"Город *"}),e.jsx("input",{type:"text",id:"city",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.city,onChange:t=>l("city",t.target.value),required:!0}),i.city&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.city})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Департамент *"}),e.jsx("input",{type:"text",id:"department",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.department,onChange:t=>l("department",t.target.value),required:!0}),i.department&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.department})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"employment_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип занятости *"}),e.jsxs("select",{id:"employment_type",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.employment_type,onChange:t=>l("employment_type",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Выберите тип занятости"}),F.map((t,r)=>e.jsx("option",{value:t,children:t},r))]}),i.employment_type&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.employment_type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Статус *"}),e.jsxs("select",{id:"status",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.status,onChange:t=>l("status",t.target.value),required:!0,children:[e.jsx("option",{value:"draft",children:"Черновик"}),e.jsx("option",{value:"published",children:"Опубликовано"})]}),i.status&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.status})]})]}),a.status==="published"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"published_at",className:"block text-sm font-medium text-gray-700 mb-1",children:"Дата публикации"}),e.jsx("input",{type:"date",id:"published_at",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:a.published_at,onChange:t=>l("published_at",t.target.value)}),i.published_at&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.published_at})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-700 mb-1",children:"Описание вакансии *"}),e.jsx("textarea",{id:"body",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:c,rows:"10",onChange:t=>v(t.target.value),placeholder:"Введите описание вакансии. Каждый абзац будет отображаться отдельно.",required:!0}),i.body&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.body})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"functional_responsibilities",className:"block text-sm font-medium text-gray-700 mb-1",children:"Функциональные обязанности"}),e.jsx("textarea",{id:"functional_responsibilities",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:p,onChange:t=>o(t.target.value,"functional_responsibilities",y),rows:"8",placeholder:"Введите функциональные обязанности. Каждый пункт с новой строки."}),i.functional_responsibilities&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.functional_responsibilities})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"qualification_requirements",className:"block text-sm font-medium text-gray-700 mb-1",children:"Квалификационные требования"}),e.jsx("textarea",{id:"qualification_requirements",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:x,onChange:t=>o(t.target.value,"qualification_requirements",j),rows:"8",placeholder:"Введите квалификационные требования. Каждый пункт с новой строки."}),i.qualification_requirements&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.qualification_requirements})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"application_procedure",className:"block text-sm font-medium text-gray-700 mb-1",children:"Порядок подачи заявки"}),e.jsx("textarea",{id:"application_procedure",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:b,onChange:t=>o(t.target.value,"application_procedure",N),rows:"6",placeholder:"Введите порядок подачи заявки. Каждый шаг с новой строки."}),i.application_procedure&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.application_procedure})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end",children:[e.jsx("button",{type:"button",className:"mr-3 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",onClick:()=>window.history.back(),children:"Отмена"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:_,children:_?"Сохранение...":"Сохранить изменения"})]})]})]})})})})]})}D.layout=s=>e.jsx(R,{title:"Редактирование вакансии",children:s});export{D as default};
