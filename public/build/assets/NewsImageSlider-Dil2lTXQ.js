import{r as n,R as C,j as r}from"./app-BdnHLJnp.js";function k({images:i=[],className:c="",height:d="160px",showDots:D=!0,showCounter:N=!1,autoPlay:I=!0,interval:f=3e3}){const[l,g]=n.useState(0),[v,u]=n.useState(new Set),[b,w]=n.useState(new Set),[E,m]=n.useState(!0),M=n.useCallback(t=>{if(!t||typeof t!="string")return t;const e=t.trim();return e.startsWith("http")?e:e.startsWith("/storage/news/")?e.replace("/storage/news/","/img/news/"):e.startsWith("/img/news/")?e:e.startsWith("/")&&!e.startsWith("/storage/")&&!e.startsWith("/img/")?`/img/news${e}`:e.startsWith("/")?e:`/img/news/${e}`},[]),s=C.useMemo(()=>!Array.isArray(i)||i.length===0?[]:i.filter(e=>{if(!e||typeof e!="string")return!1;const a=e.trim();if(a==="")return!1;const p=[".jpg",".jpeg",".png",".gif",".webp",".svg"].some(A=>a.toLowerCase().includes(A));return!p&&(a.startsWith("http")||a.startsWith("/"))?!0:p}).map(M),[i,M]),h=n.useCallback(t=>{u(e=>{const a=new Set(e);return a.add(t),a.size>=s.length&&m(!1),a})},[s.length]),x=n.useCallback((t,e)=>{console.error("Ошибка загрузки изображения:",e),w(a=>{const o=new Set(a);return o.add(t),o}),u(a=>{const o=new Set(a);return o.add(t),o.size>=s.length&&m(!1),o})},[s.length]),j=n.useCallback(()=>["/img/news/placeholder.jpg","/img/placeholder.jpg","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04MCAxMDBDODAgODkuNTQ0IDg4LjU0NCA4MSA5OSA4MUgxMDFDMTExLjQ1NiA4MSAxMjAgODkuNTQ0IDEyMCAxMDBWMTEwQzEyMCAxMjAuNDU2IDExMS40NTYgMTI5IDEwMSAxMjlIOTlDODguNTQ0IDEyOSA4MCAxMjAuNDU2IDgwIDExMFYxMDBaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xMDAgMTQwQzExMC40NTYgMTQwIDEyMCAxMzAuNDU2IDEyMCAxMjBIMTgwQzE4MCAxMzAuNDU2IDE3MC40NTYgMTQwIDE2MCAxNDBIMTAwWiIgZmlsbD0iIzlCOUJBMCIvPgo8L3N2Zz4K"][0],[]);n.useEffect(()=>{u(new Set),w(new Set),m(s.length>0),g(0)},[s]),n.useEffect(()=>{if(!I||s.length<=1)return;const t=setInterval(()=>{g(e=>(e+1)%s.length)},f);return()=>clearInterval(t)},[s.length,I,f]);const y=n.useCallback(t=>{g(t)},[]);return!s||s.length===0?r.jsx("div",{className:`relative overflow-hidden rounded-lg bg-gray-200 flex items-center justify-center ${c}`,style:{height:d},children:r.jsxs("div",{className:"text-gray-400 text-center",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.jsx("p",{className:"text-sm",children:"Нет изображений"})]})}):s.length===1?r.jsx("div",{className:`relative overflow-hidden rounded-lg ${c}`,style:{height:d},children:r.jsx("img",{src:s[0],alt:"Изображение новости",className:"w-full h-full object-cover",onLoad:()=>h(0),onError:t=>{x(0,s[0]),t.target.onerror=null,t.target.src=j()}})}):r.jsxs("div",{className:`relative overflow-hidden rounded-lg ${c}`,style:{height:d},children:[r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("img",{src:s[l],alt:`Изображение новости ${l+1}`,className:`w-full h-full object-cover transition-opacity duration-500 ${v.has(l)?"opacity-100":"opacity-0"}`,onLoad:()=>h(l),onError:t=>{x(l,s[l]),t.target.onerror=null,t.target.src=j()}}),s.map((t,e)=>e!==l&&r.jsx("img",{src:t,alt:"",className:"hidden",onLoad:()=>h(e),onError:()=>x(e,t)},e)),b.has(l)&&r.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:r.jsxs("div",{className:"text-center text-gray-500",children:[r.jsx("svg",{className:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 16.5c-.77.833.192 2.5 1.732 2.5z"})}),r.jsx("p",{className:"text-xs",children:"Ошибка загрузки"})]})}),D&&s.length>1&&r.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1 z-10",children:s.map((t,e)=>r.jsx("button",{onClick:()=>y(e),className:`w-2 h-2 rounded-full transition-all duration-300 ${e===l?"bg-white shadow-sm":"bg-white bg-opacity-50 hover:bg-opacity-75"}`,"aria-label":`Перейти к изображению ${e+1}`},e))})]}),N&&s.length>1&&r.jsxs("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-xs z-10",children:[l+1," / ",s.length]})]})}export{k as N};
