import{r as g,W as w,j as e,a as u}from"./app-CYo44y_y.js";import{A as C}from"./AdminLayout-enUz4bpd.js";import{R as k,C as S}from"./CategoryCheckboxes-BRmu-yf9.js";import{M as D,D as M,T as _}from"./DateTimePicker-DQoDFgXd.js";import{S as L}from"./StatusSelector-B35jy6tl.js";import{T,I as o}from"./TextInput-BPiHo3Qo.js";import{I as d}from"./InputLabel-E0asrDBO.js";import{P as I}from"./PrimaryButton-Ba5usR6s.js";import"./transition-fgOBoZx1.js";import"./use-is-mounted-Cx2EdkYN.js";function O({availableCategories:p=[]}){const[l,c]=g.useState([]),[m,b]=g.useState(!1),{data:s,setData:r,post:j,processing:x,errors:i,reset:f}=w({title:"",content:"",category:[],tags:[],status:"draft",publish_date:"",media:[]}),h=t=>{t.preventDefault();const a={...s,images:l};j(route("admin.news.store"),{data:a,onSuccess:()=>{f(),c([])},onError:n=>{console.error("Ошибки валидации:",n)}})},N=t=>{const a=Array.isArray(t)?t:[t];c(n=>[...n,...a]),r("images",[...l,...a])},y=t=>{const a=l.filter(n=>n.id!==t);c(a),r("images",a)},v=t=>{if(r("status",t),t==="scheduled"&&!s.publish_date){const a=new Date;a.setDate(a.getDate()+1),a.setHours(9,0,0,0),r("publish_date",a.toISOString())}t==="published"&&!s.publish_date&&r("publish_date",new Date().toISOString())};return e.jsx(C,{children:e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8 bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Создать новость"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Создайте новую новость с помощью современного редактора"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(u,{href:route("admin.news"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Назад к списку"]}),e.jsxs("button",{type:"button",onClick:()=>b(!m),className:"inline-flex items-center px-4 py-2 border border-blue-300 rounded-lg shadow-sm text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition",children:[e.jsxs("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),m?"Скрыть":"Показать"," превью"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Заголовок"}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"title",value:"Заголовок новости *"}),e.jsx(T,{id:"title",type:"text",value:s.title,onChange:t=>r("title",t.target.value),className:"mt-1 block w-full text-lg",placeholder:"Введите заголовок новости...",required:!0,autoFocus:!0}),e.jsx(o,{message:i.title,className:"mt-2"}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["Символов: ",s.title.length," / 255"]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Содержимое"}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"content",value:"Текст новости *"}),e.jsx("div",{className:"mt-2",children:e.jsx(k,{content:s.content,onChange:t=>r("content",t),error:i.content,placeholder:"Начните вводить текст новости..."})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Используйте панель инструментов для форматирования текста"})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Медиа файлы",l.length>0&&e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",l.length," файлов)"]})]}),e.jsx(D,{existingMedia:l,onMediaUploaded:N,onMediaRemoved:y,maxFiles:20}),e.jsx(o,{message:i.media,className:"mt-2"})]}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u,{href:route("admin.news"),className:"inline-flex items-center px-6 py-3 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition",children:"Отмена"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{r("status","draft"),setTimeout(()=>h({preventDefault:()=>{}}),100)},disabled:x,className:"inline-flex items-center px-6 py-3 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition disabled:opacity-50",children:"💾 Сохранить как черновик"}),e.jsx(I,{disabled:x,className:"px-6 py-3 text-sm font-medium rounded-lg",children:x?"⏳ Публикуем...":"🚀 Опубликовать"})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Публикация"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{value:"Статус публикации"}),e.jsx(L,{value:s.status,onChange:v,className:"mt-2"}),e.jsx(o,{message:i.status,className:"mt-2"})]}),(s.status==="scheduled"||s.status==="published")&&e.jsxs("div",{children:[e.jsx(d,{value:"Дата публикации"}),e.jsx(M,{value:s.publish_date,onChange:t=>r("publish_date",t),className:"mt-2",minDate:s.status==="scheduled"?new Date:null,allowPast:s.status==="published"}),e.jsx(o,{message:i.publish_date,className:"mt-2"}),s.status==="published"&&e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"💡 Можно установить дату в прошлом для публикации задним числом"})]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Категории *"}),e.jsx(S,{selectedCategories:s.category,onCategoriesChange:t=>r("category",t),availableCategories:p,error:i.category})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Теги",e.jsx("span",{className:"text-gray-500 text-sm font-normal ml-2",children:"(необязательно)"})]}),e.jsx(_,{selectedTags:s.tags,onChange:t=>r("tags",t)}),e.jsx(o,{message:i.tags,className:"mt-2"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"💡 Подсказки"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Используйте редактор для форматирования текста"}),e.jsx("li",{children:"• Загрузите изображения или видео"}),e.jsx("li",{children:"• Первое изображение будет обложкой"}),e.jsx("li",{children:"• Можно запланировать публикацию"})]})]})]})]}),m&&e.jsxs("div",{className:"mt-8 bg-white shadow-lg rounded-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Превью новости"}),s.title&&e.jsx("h3",{className:"text-3xl font-bold text-gray-900 mb-4",children:s.title}),s.category.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s.category.map((t,a)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:t},a))}),l.length>0&&l[0]&&e.jsx("div",{className:"mb-6",children:l[0].type==="image"?e.jsx("img",{src:l[0].preview||l[0].path,alt:"Обложка",className:"w-full h-auto rounded-lg shadow-md"}):e.jsx("video",{src:l[0].preview||l[0].path,controls:!0,className:"w-full h-auto rounded-lg shadow-md"})}),s.content&&e.jsx("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:s.content}}),s.tags.length>0&&e.jsx("div",{className:"mt-6 flex flex-wrap gap-2",children:s.tags.map((t,a)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs",children:["#",t]},a))}),s.publish_date&&e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:["📅 Дата публикации: ",new Date(s.publish_date).toLocaleString("ru-RU")]})]})]})})})}export{O as default};
