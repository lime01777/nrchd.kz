import{q as y,r as f,W as w,j as e,Y as p,a as _,y as l}from"./app-Dx0pQLKn.js";import{A as C}from"./AdminLayout-Dtb4iCn7.js";import"./transition-Dabao_dA.js";import"./use-is-mounted-DzbNDF9D.js";function k({application:s,users:x,statuses:h}){var m;const{flash:n={}}=y().props,[g,i]=f.useState(!1),{data:c,setData:d,processing:o}=w({status:s.status,admin_notes:s.admin_notes||"",assigned_to:((m=s.assigned_user)==null?void 0:m.id)||""}),b=t=>{l.patch(route("admin.contact-applications.update-status",s.id),{status:t},{preserveScroll:!0,onSuccess:()=>{d("status",t)}})},u=()=>{l.patch(route("admin.contact-applications.update-notes",s.id),{admin_notes:c.admin_notes},{preserveScroll:!0,onSuccess:()=>{i(!1)}})},j=t=>{l.patch(route("admin.contact-applications.assign",s.id),{assigned_to:t||null},{preserveScroll:!0,onSuccess:()=>{d("assigned_to",t)}})},v=()=>{confirm("Вы уверены, что хотите удалить эту заявку?")&&l.delete(route("admin.contact-applications.destroy",s.id))},N=t=>{const r={blue:"bg-blue-100 text-blue-800",yellow:"bg-yellow-100 text-yellow-800",green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",gray:"bg-gray-100 text-gray-800"};return r[t]||r.gray},a=t=>{const r={general:"#6366f1",tech_competence:"#8b5cf6",medical_tourism:"#10b981",medical_accreditation:"#f59e0b",health_rate:"#3b82f6",clinics:"#ec4899",other:"#6b7280"};return r[t]||r.other};return e.jsxs(e.Fragment,{children:[e.jsx(p,{title:`Заявка от ${s.name}`}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs(_,{href:route("admin.contact-applications.index"),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Назад к списку заявок"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Направление:"}),e.jsx("span",{className:"inline-block text-sm font-semibold px-4 py-2 rounded-lg",style:{backgroundColor:a(s.category)+"20",color:a(s.category),border:`2px solid ${a(s.category)}`},children:s.category_label})]})]}),n&&n.success&&e.jsx("div",{className:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded",children:n.success}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg border-l-4",style:{borderLeftColor:a(s.category)},children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Информация о заявителе"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${N(s.status_color)}`,children:s.status_label})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Имя:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:s.name})]}),e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Email:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:e.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:text-blue-800",children:s.email})})]}),e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Телефон:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:e.jsx("a",{href:`tel:${s.phone}`,className:"text-blue-600 hover:text-blue-800",children:s.phone})})]}),s.organization&&e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Организация:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:s.organization})]}),s.project_name&&e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Проект:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:s.project_name})]}),e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Дата подачи:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:s.created_at})]}),s.reviewed_at&&e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Просмотрена:"}),e.jsx("div",{className:"col-span-2 text-sm text-gray-900",children:s.reviewed_at})]})]})]})}),s.subject&&e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Тема"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.subject})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Сообщение"}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:s.message})]})}),s.attachment_path&&e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Вложение"}),e.jsxs("a",{href:s.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Скачать вложение"]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Изменить статус"}),e.jsx("div",{className:"space-y-2",children:Object.entries(h).map(([t,r])=>e.jsx("button",{onClick:()=>b(t),className:`w-full text-left px-3 py-2 text-sm rounded ${s.status===t?"bg-blue-100 text-blue-800 font-medium":"hover:bg-gray-100"}`,disabled:o,children:r},t))})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Назначить ответственного"}),e.jsxs("select",{value:c.assigned_to,onChange:t=>j(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:o,children:[e.jsx("option",{value:"",children:"Не назначена"}),x.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),s.assigned_user&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Текущий ответственный: ",e.jsx("span",{className:"font-medium",children:s.assigned_user.name})]})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Заметки администратора"}),g?e.jsxs("div",{children:[e.jsx("textarea",{value:c.admin_notes,onChange:t=>d("admin_notes",t.target.value),rows:6,className:"w-full border border-gray-300 rounded-md p-2 text-sm",placeholder:"Добавьте заметки..."}),e.jsxs("div",{className:"mt-2 flex space-x-2",children:[e.jsx("button",{onClick:u,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",disabled:o,children:"Сохранить"}),e.jsx("button",{onClick:()=>{d("admin_notes",s.admin_notes||""),i(!1)},className:"px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300",children:"Отмена"})]})]}):e.jsxs("div",{children:[s.admin_notes?e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap mb-3",children:s.admin_notes}):e.jsx("p",{className:"text-sm text-gray-500 italic mb-3",children:"Заметок нет"}),e.jsx("button",{onClick:()=>i(!0),className:"text-sm text-blue-600 hover:text-blue-800",children:"Редактировать"})]})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Действия"}),e.jsx("button",{onClick:v,className:"w-full px-4 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Удалить заявку"})]})})]})]})]})})]})}k.layout=s=>e.jsx(C,{children:s});export{k as default};
