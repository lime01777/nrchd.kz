import{r as d,j as e,a as o,y as c}from"./app-fjsViU6A.js";import{A as _}from"./AdminLayout-QGna9wro.js";import{S as A}from"./StatusBadge-B0johWS6.js";import"./transition-Bu5ffZxN.js";import"./use-is-mounted-BOtRnQtQ.js";function D({news:r,filters:l}){const[x,m]=d.useState((l==null?void 0:l.search)||""),[h,u]=d.useState((l==null?void 0:l.status)||""),[g,p]=d.useState((l==null?void 0:l.category)||"");d.useState(!1);const[a,i]=d.useState([]),j=s=>{s.preventDefault(),c.get(route("admin.news"),{search:x,status:h,category:g},{preserveState:!0,replace:!0})},f=()=>{m(""),u(""),p(""),c.get(route("admin.news"),{},{preserveState:!0,replace:!0})},b=s=>{confirm("Вы уверены, что хотите удалить эту новость?")&&c.delete(route("admin.news.destroy",s),{onSuccess:()=>{i(a.filter(t=>t!==s))}})},v=()=>{a.length!==0&&confirm(`Вы уверены, что хотите удалить ${a.length} новостей?`)&&c.post(route("admin.news.bulk"),{action:"delete",ids:a},{onSuccess:()=>{i([])}})},y=()=>{a.length===r.data.length?i([]):i(r.data.map(s=>s.id))},N=s=>{a.includes(s)?i(a.filter(t=>t!==s)):i([...a,s])},w=s=>s?new Date(s).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",k=()=>{const s=new Set;return r.data.forEach(t=>{Array.isArray(t.category)?t.category.forEach(n=>s.add(n)):t.category&&s.add(t.category)}),Array.from(s).sort()},L=s=>s.images?(Array.isArray(s.images)?s.images:JSON.parse(s.images||"[]")).length:0,C=s=>{if(s.main_image)return s.main_image;if(s.image)return s.image;if(!s.images)return null;try{const t=Array.isArray(s.images)?s.images:JSON.parse(s.images||"[]");if(t.length>0){const n=t[0];return typeof n=="string"?n:n==null?void 0:n.path}}catch(t){console.error("Error parsing images:",t,s.images)}return null};return e.jsx(_,{children:e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shadow-lg p-8 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Управление новостями"}),e.jsxs("p",{className:"mt-2 text-blue-100",children:["Всего новостей: ",r.total]})]}),e.jsxs(o,{href:route("admin.news.create"),className:"inline-flex items-center px-6 py-3 bg-white text-blue-600 rounded-lg shadow-lg text-sm font-bold hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-white transition transform hover:scale-105",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Создать новость"]})]})}),e.jsxs("div",{className:"mb-6 bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[300px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"🔍 Поиск"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:x,onChange:s=>m(s.target.value),placeholder:"Поиск по заголовку или содержимому...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),e.jsx("svg",{className:"absolute left-3 top-3 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsxs("div",{className:"min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Статус"}),e.jsxs("select",{value:h,onChange:s=>u(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Все статусы"}),e.jsx("option",{value:"published",children:"Опубликовано"}),e.jsx("option",{value:"draft",children:"Черновик"}),e.jsx("option",{value:"scheduled",children:"Запланировано"}),e.jsx("option",{value:"archived",children:"Архив"})]})]}),e.jsxs("div",{className:"min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Категория"}),e.jsxs("select",{value:g,onChange:s=>p(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Все категории"}),k().map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:j,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:"Применить"}),e.jsx("button",{onClick:f,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Сбросить"})]})]}),a.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["Выбрано: ",a.length," новостей"]}),e.jsx("button",{onClick:v,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm font-medium",children:"🗑 Удалить выбранные"})]})})]}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:r.data.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Новостей нет"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Создайте первую новость"}),e.jsx("div",{className:"mt-6",children:e.jsxs(o,{href:route("admin.news.create"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Создать новость"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:a.length===r.data.length,onChange:y,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Превью"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Новость"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Категории"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Дата"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.data.map(s=>{const t=C(s),n=L(s);return e.jsxs("tr",{className:`hover:bg-gray-50 transition ${a.includes(s.id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:a.includes(s.id),onChange:()=>N(s.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4",children:t?e.jsx("img",{src:t,alt:s.title,className:"h-16 w-24 object-cover rounded-lg shadow-sm"}):e.jsx("div",{className:"h-16 w-24 bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900 mb-1 line-clamp-2",children:s.title}),e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Slug: ",e.jsx("span",{className:"font-mono",children:s.slug})]}),n>0&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),n," медиа"]}),s.views>0&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-1",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),s.views," просмотров"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1 max-w-[200px]",children:Array.isArray(s.category)?s.category.map((S,M)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-xs font-medium",children:S},M)):e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-xs font-medium",children:s.category})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(A,{status:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:w(s.publish_date||s.created_at)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.slug&&e.jsx("a",{href:route("news.show",s.slug),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-900 transition",title:"Просмотреть",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx(o,{href:route("admin.news.edit",s.id),className:"text-indigo-600 hover:text-indigo-900 transition",title:"Редактировать",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>b(s.id),className:"text-red-600 hover:text-red-900 transition",title:"Удалить",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},s.id)})})]})}),r.last_page>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[r.prev_page_url&&e.jsx(o,{href:r.prev_page_url,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Назад"}),r.next_page_url&&e.jsx(o,{href:r.next_page_url,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Вперед"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Показано с"," ",e.jsx("span",{className:"font-medium",children:r.from})," ","по"," ",e.jsx("span",{className:"font-medium",children:r.to})," ","из"," ",e.jsx("span",{className:"font-medium",children:r.total})," ","новостей"]})}),e.jsx("div",{children:e.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:r.links.map((s,t)=>e.jsx(o,{href:s.url||"#",preserveScroll:!0,className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${s.active?"z-10 bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"} ${t===0?"rounded-l-md":""} ${t===r.links.length-1?"rounded-r-md":""}`,dangerouslySetInnerHTML:{__html:s.label}},t))})})]})]})]})})]})})})}export{D as default};
