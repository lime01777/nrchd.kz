import{r as n,R as C,j as s}from"./app-DrLP75hb.js";function k({images:i=[],className:c="",height:d="160px",showDots:D=!0,showCounter:N=!1,autoPlay:I=!0,interval:f=3e3}){const[l,u]=n.useState(0),[v,g]=n.useState(new Set),[b,M]=n.useState(new Set),[E,x]=n.useState(!0),w=n.useCallback(t=>{if(!t||typeof t!="string")return t;const e=t.trim();return e.startsWith("http")||e.startsWith("/storage/")||e.startsWith("/img/")||e.startsWith("/")?e:`/storage/${e}`},[]),r=C.useMemo(()=>!Array.isArray(i)||i.length===0?[]:i.filter(e=>{if(!e||typeof e!="string")return!1;const a=e.trim();if(a==="")return!1;const p=[".jpg",".jpeg",".png",".gif",".webp",".svg"].some(A=>a.toLowerCase().includes(A));return!p&&(a.startsWith("http")||a.startsWith("/"))?!0:p}).map(w),[i,w]),m=n.useCallback(t=>{g(e=>{const a=new Set(e);return a.add(t),a.size>=r.length&&x(!1),a})},[r.length]),h=n.useCallback((t,e)=>{console.error("Ошибка загрузки изображения:",e),M(a=>{const o=new Set(a);return o.add(t),o}),g(a=>{const o=new Set(a);return o.add(t),o.size>=r.length&&x(!1),o})},[r.length]),j=n.useCallback(()=>["/img/news/placeholder.jpg","/img/placeholder.jpg","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04MCAxMDBDODAgODkuNTQ0IDg4LjU0NCA4MSA5OSA4MUgxMDFDMTExLjQ1NiA4MSAxMjAgODkuNTQ0IDEyMCAxMDBWMTEwQzEyMCAxMjAuNDU2IDExMS40NTYgMTI5IDEwMSAxMjlIOTlDODguNTQ0IDEyOSA4MCAxMjAuNDU2IDgwIDExMFYxMDBaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xMDAgMTQwQzExMC40NTYgMTQwIDEyMCAxMzAuNDU2IDEyMCAxMjBIMTgwQzE4MCAxMzAuNDU2IDE3MC40NTYgMTQwIDE2MCAxNDBIMTAwWiIgZmlsbD0iIzlCOUJBMCIvPgo8L3N2Zz4K"][0],[]);n.useEffect(()=>{g(new Set),M(new Set),x(r.length>0),u(0)},[r]),n.useEffect(()=>{if(!I||r.length<=1)return;const t=setInterval(()=>{u(e=>(e+1)%r.length)},f);return()=>clearInterval(t)},[r.length,I,f]);const y=n.useCallback(t=>{u(t)},[]);return!r||r.length===0?s.jsx("div",{className:`relative overflow-hidden rounded-lg bg-gray-200 flex items-center justify-center ${c}`,style:{height:d},children:s.jsxs("div",{className:"text-gray-400 text-center",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("p",{className:"text-sm",children:"Нет изображений"})]})}):r.length===1?s.jsx("div",{className:`relative overflow-hidden rounded-lg ${c}`,style:{height:d},children:s.jsx("img",{src:r[0],alt:"Изображение новости",className:"w-full h-full object-cover",onLoad:()=>m(0),onError:t=>{h(0,r[0]),t.target.onerror=null,t.target.src=j()}})}):s.jsxs("div",{className:`relative overflow-hidden rounded-lg ${c}`,style:{height:d},children:[s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("img",{src:r[l],alt:`Изображение новости ${l+1}`,className:`w-full h-full object-cover transition-opacity duration-500 ${v.has(l)?"opacity-100":"opacity-0"}`,onLoad:()=>m(l),onError:t=>{h(l,r[l]),t.target.onerror=null,t.target.src=j()}}),r.map((t,e)=>e!==l&&s.jsx("img",{src:t,alt:"",className:"hidden",onLoad:()=>m(e),onError:()=>h(e,t)},e)),b.has(l)&&s.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-gray-500",children:[s.jsx("svg",{className:"w-6 h-6 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 16.5c-.77.833.192 2.5 1.732 2.5z"})}),s.jsx("p",{className:"text-xs",children:"Ошибка загрузки"})]})}),D&&r.length>1&&s.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1 z-10",children:r.map((t,e)=>s.jsx("button",{onClick:()=>y(e),className:`w-2 h-2 rounded-full transition-all duration-300 ${e===l?"bg-white shadow-sm":"bg-white bg-opacity-50 hover:bg-opacity-75"}`,"aria-label":`Перейти к изображению ${e+1}`},e))})]}),N&&r.length>1&&s.jsxs("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-xs z-10",children:[l+1," / ",r.length]})]})}export{k as N};
