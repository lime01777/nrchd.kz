import{r as m,W as B,j as e,a as R}from"./app-Cg-aiRh8.js";import{A as T}from"./AdminLayout-BBGvqktT.js";import{M as G,a as H,b as P}from"./MediaManager-IUgHvcJX.js";import"./transition--wkYrX6_.js";import"./use-is-mounted-DKJQzBpD.js";import"./SafeImage-p-xU4kDM.js";import"./SafeVideo-Ct1vMtWD.js";import"./mediaUtils-oRnee45q.js";const Q=["–û–±—â–∏–µ","–ê–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏—è","–û–±—É—á–µ–Ω–∏–µ","–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏","–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã","–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è","–ê–Ω–æ–Ω—Å—ã"];function $(){const[f,c]=m.useState(!1),{data:l,setData:r,post:D,processing:j,errors:i}=B({title:"",category:[],content:"",images:[],status:"–ß–µ—Ä–Ω–æ–≤–∏–∫",publishDate:new Date().toISOString().substr(0,10)}),[h,E]=m.useState(Q),[d,x]=m.useState([]),[g,v]=m.useState(""),[b,N]=m.useState(!1),[y,F]=m.useState([]),w=t=>{console.log("Create - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞:",t),F(t);const a=[],o=[];t.forEach(n=>{n instanceof File||n&&n.file?a.push(n.file||n):typeof n=="string"?o.push(n):n&&n.path&&o.push(n.path)}),r("images",o),r("image_files",a)},M=h.map(t=>({value:t,label:t})),L=(t,a)=>{let o;a?o=[...d,t]:o=d.filter(n=>n!==t),x(o),r("category",o)},A=()=>{const t=h.map(a=>a);x(t),r("category",t)},_=()=>{x([]),r("category",[])},O=()=>{const t=h.filter(a=>!d.includes(a));x(t),r("category",t)},I=()=>{if(g&&!h.includes(g)){E([...h,g]);const t=[...d,g];x(t),r("category",t),v("")}};m.useEffect(()=>{const t=a=>{b&&!a.target.closest(".category-dropdown")&&N(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[b]);const U=t=>{t.preventDefault(),c(!0);try{const a=l.category||[];if(!l.title||l.title.trim().length===0){alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫"),c(!1);return}typeof l.content!="string"&&r("content",String(l.content||"")),["–ß–µ—Ä–Ω–æ–≤–∏–∫","–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ","–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ"].includes(l.status)||r("status","–ß–µ—Ä–Ω–æ–≤–∏–∫");const o=y.filter(s=>typeof s=="string"?s:s instanceof File?s.size>0:s&&s.file?s.file.size>0:s&&s.path?s.path:!1);if(r("images",o),!l.content||l.content.replace(/<[^>]*?>/g,"").trim().length<10){alert("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤"),c(!1);return}if(a.length===0){alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é"),c(!1);return}const n=[],C=[],k=[],S=[];o.forEach(s=>{var p;if(s instanceof File||s&&s.file){const u=s.file||s;u.type.startsWith("video/")?C.push(u):n.push(u)}else if(typeof s=="string"||s&&s.path){const u=s.path||s,q=(p=u.split(".").pop())==null?void 0:p.toLowerCase();["mp4","avi","mov","wmv","flv","webm"].includes(q)?S.push(u):k.push(u)}});const z={title:l.title,content:l.content,status:l.status,publishDate:l.publishDate||"",category:a,images:[...k,...S],image_files:n,video_files:C};console.log("–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏:",{title:l.title,content_length:l.content?l.content.length:0,categories:a,media_count:o.length,status:l.status}),D(route("admin.news.store"),z,{preserveScroll:!0,timeout:6e4,onStart:()=>{console.log("–ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã...")},onProgress:s=>{console.log("–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏:",s)},onSuccess:s=>{console.log("–£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:",s),c(!1)},onError:s=>{if(console.error("–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:",s),c(!1),s.error)alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: "+s.error);else{const p=Object.values(s).flat();p.length>0&&alert(`–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
`+p.join(`
`))}},onFinish:()=>{console.log("–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã"),c(!1)}})}catch(a){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã:",a),c(!1)}},W=t=>{r("content",t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏"}),e.jsxs(R,{href:route("admin.news"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É"]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:e.jsxs("form",{onSubmit:U,className:"min-h-full",children:[e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-6",children:[e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫ *"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"text",name:"title",id:"title",value:l.title,onChange:t=>r("title",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,placeholder:"–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏"})}),i.title&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.title})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ *"}),e.jsxs("div",{className:"relative category-dropdown",children:[e.jsxs("button",{type:"button",onClick:()=>N(!b),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-md bg-white text-left text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("span",{className:d.length>0?"text-gray-900":"text-gray-500",children:d.length>0?`–í—ã–±—Ä–∞–Ω–æ: ${d.length} –∫–∞—Ç–µ–≥–æ—Ä–∏–π`:"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..."}),e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),b&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex gap-2 mb-3 pb-2 border-b border-gray-200",children:[e.jsx("button",{type:"button",onClick:A,className:"px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",children:"–í—ã–±—Ä–∞—Ç—å –≤—Å–µ"}),e.jsx("button",{type:"button",onClick:_,className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700",children:"–°–Ω—è—Ç—å –≤—ã–±–æ—Ä"}),e.jsx("button",{type:"button",onClick:O,className:"px-2 py-1 text-xs bg-purple-500 text-white rounded hover:bg-purple-600",children:"–ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å"})]}),e.jsx("div",{className:"space-y-1",children:M.map(t=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.includes(t.value),onChange:a=>L(t.value,a.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:t.label})]},t.value))}),e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:t=>v(t.target.value),placeholder:"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è",className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{type:"button",onClick:I,className:"px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600",children:"–î–æ–±–∞–≤–∏—Ç—å"})]})})]})})]}),i.category&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.category})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"–°—Ç–∞—Ç—É—Å *"}),e.jsx("div",{className:"mt-1",children:e.jsxs("select",{id:"status",name:"status",value:l.status,onChange:t=>r("status",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"–ß–µ—Ä–Ω–æ–≤–∏–∫",children:"–ß–µ—Ä–Ω–æ–≤–∏–∫"}),e.jsx("option",{value:"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ",children:"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ"}),e.jsx("option",{value:"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ",children:"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ"})]})}),i.status&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.status})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"publishDate",className:"block text-sm font-medium text-gray-700",children:"–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"date",name:"publishDate",id:"publishDate",value:l.publishDate,onChange:t=>r("publishDate",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"})}),i.publishDate&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.publishDate})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["üé• –ú–µ–¥–∏–∞ –≥–∞–ª–µ—Ä–µ—è",e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"- –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ (–¥–æ 10 —Ñ–∞–π–ª–æ–≤)"})]}),e.jsx(G,{media:y,setMedia:w,maxFiles:10}),e.jsx("div",{className:"mt-4",children:e.jsx(H,{onSelect:t=>{const a=[...y,t];w(a)},selectedMedia:y,maxFiles:10})})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ *"}),e.jsx(P,{value:l.content,onChange:W,placeholder:"–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–æ–≤–æ—Å—Ç–∏...",minHeight:"320px"}),i.content&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.content}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"–ú–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤"})]})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:j||f,children:j||f?"–°–æ–∑–¥–∞–Ω–∏–µ...":"–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å"})})]})})]})}$.layout=f=>e.jsx(T,{title:"–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏",children:f});export{$ as default};
