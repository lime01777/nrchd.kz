import{q as S,r as i,j as t,a as h,y as b}from"./app-Ba3ktX9C.js";import{A}from"./AdminLayout-DJdrG37o.js";import{S as L}from"./react-select.esm-6rX3t6XE.js";import"./transition-CWE13Hr6.js";function B(){const{news:l,filters:p,flash:c}=S().props,[a,y]=i.useState(p.search||""),[s,n]=i.useState([]),[f,d]=i.useState(!1),j=Array.from(new Set(l.flatMap(e=>Array.isArray(e.category)?e.category:[e.category]).filter(Boolean))),x=[{value:"",label:"Все категории"},...j.map(e=>({value:e,label:e}))],[o,v]=i.useState(""),u=l.filter(e=>{const r=a===""||e.title.toLowerCase().includes(a.toLowerCase())||e.category&&e.category.toLowerCase().includes(a.toLowerCase()),m=!o||(Array.isArray(e.category)?e.category.includes(o):e.category===o);return r&&m}),w=e=>{switch(e){case"Опубликовано":return"bg-green-100 text-green-800";case"Черновик":return"bg-gray-100 text-gray-800";case"Запланировано":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},N=e=>{confirm("Вы уверены, что хотите удалить эту новость?")&&b.delete(route("admin.news.destroy",e))},g=e=>{s.length!==0&&(e==="delete"&&!confirm("Вы уверены, что хотите удалить выбранные новости?")||b.post(route("admin.news.bulk"),{ids:s,action:e},{onSuccess:()=>{n([]),d(!1)}}))},k=e=>{n(r=>r.includes(e)?r.filter(m=>m!==e):[...r,e])},C=()=>{f?(n([]),d(!1)):(n(u.map(e=>e.id)),d(!0))};return t.jsxs(t.Fragment,{children:[c&&c.success&&t.jsx("div",{className:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded",children:c.success}),t.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Управление новостями"}),t.jsxs(h,{href:route("admin.news.create"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[t.jsx("svg",{className:"h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Добавить новость"]})]}),t.jsxs("div",{className:"mb-4 flex flex-wrap gap-2 items-center",children:[t.jsx("input",{type:"checkbox",checked:f,onChange:C,className:"form-checkbox h-5 w-5 text-blue-600 mr-2"}),t.jsx("span",{className:"mr-4 text-sm",children:"Выделить все"}),t.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm",onClick:()=>g("publish"),disabled:s.length===0,children:"Опубликовать"}),t.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 text-sm",onClick:()=>g("draft"),disabled:s.length===0,children:"В черновик"}),t.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",onClick:()=>g("delete"),disabled:s.length===0,children:"Удалить"}),s.length>0&&t.jsxs("span",{className:"ml-4 text-sm text-gray-500",children:["Выбрано: ",s.length]})]}),t.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 items-center",children:[t.jsxs("div",{className:"relative w-full sm:w-1/2",children:[t.jsx("input",{type:"text",placeholder:"Поиск новостей...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:a,onChange:e=>y(e.target.value)}),t.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),t.jsx("div",{className:"w-full sm:w-1/3 min-w-[180px]",children:t.jsx(L,{options:x,value:x.find(e=>e.value===o)||x[0],onChange:e=>v(e.value),classNamePrefix:"react-select",placeholder:"Категория...",isSearchable:!1,styles:{control:e=>({...e,minHeight:"42px",borderRadius:"8px",borderColor:"#cbd5e1",boxShadow:"none"}),option:(e,r)=>({...e,background:r.isFocused?"#f3f4f6":"white",color:"#1e293b"})}})})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:u.length>0?u.map(e=>t.jsxs("div",{className:`bg-white shadow rounded-lg flex flex-col relative border ${s.includes(e.id)?"border-blue-500":"border-transparent"}`,children:[t.jsx("input",{type:"checkbox",checked:s.includes(e.id),onChange:()=>k(e.id),className:"absolute top-2 left-2 z-10 h-4 w-4 text-blue-600 form-checkbox bg-white border-gray-300 rounded shadow",style:{boxShadow:"0 1px 4px #cbd5e1"}}),e.image&&t.jsx("img",{src:e.image,alt:e.title,className:"h-40 w-full object-cover rounded-t-lg"}),t.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs text-gray-500 pl-6",children:e.category}),t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${w(e.status)}`,children:e.status})]}),t.jsx("h3",{className:"text-lg font-semibold text-blue-700 mb-1 truncate",title:e.title,children:e.title}),t.jsx("div",{className:"text-xs text-gray-400 mb-2",children:e.publish_date||e.publishDate||"Не опубликовано"}),t.jsxs("div",{className:"mt-auto flex flex-wrap gap-2",children:[t.jsx(h,{href:route("admin.news.edit",e.id),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-5 font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Изменить"}),t.jsx(h,{href:route("news.show",e.slug),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Просмотр"}),t.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-5 font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",onClick:()=>N(e.id),children:"Удалить"})]})]})]},e.id)):t.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"Новости не найдены"})}),t.jsx("div",{className:"mt-6",children:t.jsx("nav",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex-1 flex justify-between",children:[t.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:text-gray-500",children:"Предыдущая"}),t.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:text-gray-500",children:"Следующая"})]})})})]})}B.layout=l=>t.jsx(A,{title:"Управление новостями",children:l});export{B as default};
