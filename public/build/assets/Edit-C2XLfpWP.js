import{W as y,r as o,j as e,Y as f,a as j}from"./app-BxwNkF6T.js";import{A as N}from"./AdminLayout-Cm37Wr-r.js";import"./transition-jRrr3s2M.js";function v({vacancy:r}){const x=t=>!t||!Array.isArray(t)?"":t.map(s=>s.type==="paragraph"&&s.data&&s.data.text?s.data.text:"").join(`

`),{data:l,setData:d,put:p,processing:m,errors:a}=y({title:r.title||"",slug:r.slug||"",excerpt:r.excerpt||"",body:x(r.body)||"",city:r.city||"",department:r.department||"",employment_type:r.employment_type||"",status:r.status||"draft",published_at:r.published_at?new Date(r.published_at).toISOString().substr(0,10):""}),[w,c]=o.useState(!1);o.useEffect(()=>{l.status==="published"&&!l.published_at&&d("published_at",new Date().toISOString().substr(0,10))},[l.status]);const[_,b]=o.useState("");o.useEffect(()=>{if(r.body&&r.body.blocks){const t=r.body.blocks.map(s=>{if(s.type==="paragraph")return`<p>${s.data.text}</p>`;if(s.type==="header")return`<h${s.data.level}>${s.data.text}</h${s.data.level}>`;if(s.type==="list"){const n=s.data.style==="ordered"?"ol":"ul",u=s.data.items.map(i=>`<li>${i}</li>`).join("");return`<${n}>${u}</${n}>`}return""}).join("");b(t)}},[r]);const h=["Полная занятость","Частичная занятость","Проектная работа","Стажировка","Удаленная работа"],g=t=>{t.preventDefault(),c(!0);try{const n=l.body.split(`
`).filter(i=>i.trim()!=="").map(i=>({type:"paragraph",data:{text:i.trim()}})),u=l.status==="published"&&!l.published_at?new Date().toISOString().substr(0,10):l.published_at;p(route("vacancies.update",r.id),{...l,body:n,published_at:u})}catch(s){console.error("Ошибка при отправке формы:",s),c(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(f,{title:"Редактирование вакансии"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsxs("div",{className:"mb-6 flex justify-between",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["Редактирование вакансии: ",r.title]}),e.jsx(j,{href:route("vacancies.index"),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Назад к списку"})]}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Название *"}),e.jsx("input",{type:"text",id:"title",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.title,onChange:t=>d("title",t.target.value),required:!0}),a.title&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.title})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 mb-1",children:"URL slug (опционально)"}),e.jsx("input",{type:"text",id:"slug",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.slug,onChange:t=>d("slug",t.target.value),placeholder:"Оставьте пустым для автоматической генерации"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Если оставить пустым, slug будет сгенерирован автоматически из названия"}),a.slug&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.slug})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"excerpt",className:"block text-sm font-medium text-gray-700 mb-1",children:"Краткое описание"}),e.jsx("textarea",{id:"excerpt",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",rows:"3",value:l.excerpt,onChange:t=>d("excerpt",t.target.value)}),a.excerpt&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.excerpt})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"Город *"}),e.jsx("input",{type:"text",id:"city",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.city,onChange:t=>d("city",t.target.value),required:!0}),a.city&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.city})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Департамент *"}),e.jsx("input",{type:"text",id:"department",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.department,onChange:t=>d("department",t.target.value),required:!0}),a.department&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.department})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"employment_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип занятости *"}),e.jsxs("select",{id:"employment_type",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.employment_type,onChange:t=>d("employment_type",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Выберите тип занятости"}),h.map((t,s)=>e.jsx("option",{value:t,children:t},s))]}),a.employment_type&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.employment_type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Статус *"}),e.jsxs("select",{id:"status",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.status,onChange:t=>d("status",t.target.value),required:!0,children:[e.jsx("option",{value:"draft",children:"Черновик"}),e.jsx("option",{value:"published",children:"Опубликовано"})]}),a.status&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.status})]})]}),l.status==="published"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"published_at",className:"block text-sm font-medium text-gray-700 mb-1",children:"Дата публикации"}),e.jsx("input",{type:"date",id:"published_at",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.published_at,onChange:t=>d("published_at",t.target.value)}),a.published_at&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.published_at})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-700 mb-1",children:"Описание вакансии *"}),e.jsx("textarea",{id:"body",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200",value:l.body,rows:"10",onChange:t=>d("body",t.target.value),required:!0}),a.body&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:a.body})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end",children:[e.jsx("button",{type:"button",className:"mr-3 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",onClick:()=>window.history.back(),children:"Отмена"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:m,children:m?"Сохранение...":"Сохранить изменения"})]})]})]})})})})]})}v.layout=r=>e.jsx(N,{title:"Редактирование вакансии",children:r});export{v as default};
