import{q as F,W as H,r as q,j as e,a as _,Y as P,y as k}from"./app-CFw-QUY9.js";import{L as R}from"./LayoutNews-D95Taj6t.js";import{N as K}from"./NewsImageSlider-B5bnZdwA.js";import{i as U}from"./mediaUtils-oRnee45q.js";import{t as Y}from"./TranslationService-4OikcUHb.js";import"./Footer-B-PucgMu.js";const a=(u,l="")=>{try{return Y.t(u,l||u)}catch(f){return console.warn("[News/Index] Ошибка получения перевода:",f),l||u}};function ee({section:u}){var E;const{news:l,filters:f={},section:I,availableTags:S=[]}=F().props,p=u||I||{type:"news",title:"Новости",subtitle:"",description:""},i=p.type||"news",c=i==="media",{data:b,setData:w,processing:L}=H({search:f.search??"",tag:f.tag??""}),j=q.useMemo(()=>{if(!(l!=null&&l.data))return[];const t=s=>!s||typeof s!="string"?"":s.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();return l.data.map(s=>{const o=Array.isArray(s.media)?s.media:[],x=new Set((Array.isArray(s.images)?s.images:[]).filter(Boolean));o.filter(r=>(r==null?void 0:r.type)==="image").forEach(r=>{const m=r.url||r.path;m&&x.add(m)});const y=Array.from(x),n=[],d=new Set,h=r=>{if(!r)return;if(typeof r=="string"){const g=r,N=`${g}-${n.length}`;if(d.has(N))return;d.add(N),n.push({id:N,type:"video",src:g,url:g,path:g,is_external:g.startsWith("http"),is_embed:!1});return}const m=r.id||`${r.url||r.path}-${n.length}`;d.has(m)||(d.add(m),n.push({...r,src:r.embed_url||r.url||r.path||null}))};Array.isArray(s.videos)&&s.videos.forEach(h),o.filter(r=>(r==null?void 0:r.type)==="video").forEach(h);const D=n.map(r=>r.src).filter(Boolean),T=y.filter(r=>!U(r)),v=s.excerpt&&s.excerpt.trim().length>0?s.excerpt:t(s.body||"").slice(0,220),W=v?`${v}${v.length>=220?"…":""}`:"";return{...s,galleryImages:T,galleryVideos:D,videoItems:n,preparedExcerpt:W}})},[l]),C=(t={})=>{const s={...b,type:i,...t};k.get(route("news.index"),s,{preserveScroll:!0,preserveState:!0})},M=t=>{t.preventDefault(),C()},V=()=>{w("search",""),w("tag",""),k.get(route("news.index"),{search:"",tag:"",type:i},{preserveScroll:!0,preserveState:!0,onFinish:()=>{var t;return(t=window==null?void 0:window.scrollTo)==null?void 0:t.call(window,{top:0,behavior:"smooth"})}})};((E=l==null?void 0:l.meta)==null?void 0:E.total)??(l==null?void 0:l.total)??j.length;const $=b.tag||"",z=t=>{const s=$===t?"":t;w("tag",s),C({tag:s})},A=t=>{t!==i&&k.get(route("news.index"),{...b,type:t},{preserveScroll:!0,preserveState:!0})},B=()=>e.jsxs("div",{className:"bg-gradient-to-b from-white via-blue-50/30 to-blue-100/20 py-16 sm:py-20 lg:py-24",children:[e.jsx(P,{title:p.title||a("news.meta.title","Новости"),meta:[{name:"description",content:p.description||a("news.meta.description","Последние новости Национального научного центра развития здравоохранения.")}]}),e.jsx("div",{className:"container mx-auto max-w-6xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden rounded-3xl border border-blue-100 bg-gradient-to-br from-blue-50 via-white to-blue-100 p-10 shadow-lg",children:e.jsxs("div",{className:"flex flex-col gap-10 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("p",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-blue-600",children:c?"СМИ О НАС":"НОВОСТИ"}),e.jsx("h1",{className:"mt-4 text-4xl font-extrabold leading-tight text-gray-900 lg:text-5xl",children:p.subtitle||(c?"Публикации в ведущих СМИ":"Актуальные события ННЦРЗ")}),e.jsx("p",{className:"mt-5 text-lg leading-relaxed text-gray-600",children:p.description||(c?"Читайте статьи и интервью о деятельности центра из авторитетных источников.":"Следите за обновлениями и важными новостями Национального научного центра развития здравоохранения.")}),e.jsx("form",{className:"mt-8 w-full rounded-2xl border border-white/80 bg-white/70 p-6 shadow-inner backdrop-blur",onSubmit:M,children:e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-end lg:gap-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"block text-xs font-semibold uppercase tracking-[0.2em] text-gray-500",children:c?"Поиск по источнику или заголовку":a("news.filters.search.label","Поиск по ключевому слову")}),e.jsx("input",{type:"text",value:b.search,onChange:t=>w("search",t.target.value),placeholder:c?"Например: Forbes, Kazinform, интервью":a("news.filters.search.placeholder","Например: медицина будущего"),className:"mt-2 w-full rounded-xl border border-blue-100 px-4 py-3 text-base shadow-sm transition focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-200"})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end",children:[e.jsx("button",{type:"submit",disabled:L,className:"inline-flex items-center justify-center rounded-xl bg-blue-600 px-6 py-3 text-sm font-semibold text-white shadow transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:L?a("news.filters.search.processing","Поиск..."):a("news.filters.search.cta","Найти")}),e.jsx("button",{type:"button",onClick:V,className:"inline-flex items-center justify-center rounded-xl border border-blue-100 bg-white px-5 py-3 text-sm font-semibold text-blue-600 transition hover:border-blue-200 hover:bg-blue-50",children:a("news.filters.search.reset","Сбросить")})]})]})}),S.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-gray-500",children:c?"Упоминания":"Теги новостей"}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:S.map(t=>{const s=$===t;return e.jsxs("button",{type:"button",onClick:()=>z(t),className:`inline-flex items-center rounded-full border px-4 py-2 text-sm font-medium transition ${s?"border-blue-600 bg-blue-600 text-white shadow":"border-transparent bg-white/70 text-gray-700 hover:border-blue-200 hover:text-blue-600"}`,children:["#",t]},t)})})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 md:items-end",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Разделы"}),e.jsxs("div",{className:"relative flex w-full max-w-xs items-center rounded-full border border-blue-100 bg-white/90 p-1 shadow-inner backdrop-blur",children:[e.jsx("span",{className:`pointer-events-none absolute inset-y-0 left-0 w-1/2 rounded-full bg-blue-600 shadow transition-transform duration-300 ease-out ${i==="media"?"translate-x-full":""}`}),e.jsx("button",{type:"button",onClick:()=>A("news"),className:`relative z-10 flex-1 rounded-full px-4 py-2 text-sm font-semibold transition ${i==="news"?"text-white":"text-gray-600 hover:text-blue-600"}`,children:"Новости"}),e.jsx("button",{type:"button",onClick:()=>A("media"),className:`relative z-10 flex-1 rounded-full px-4 py-2 text-sm font-semibold transition ${i==="media"?"text-white":"text-gray-600 hover:text-blue-600"}`,children:"СМИ о нас"})]})]})]})})})]});return e.jsxs(R,{renderCustomHero:B,children:[j.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-gray-200 bg-white py-16 text-center shadow-sm",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:a("news.empty.title","Новости не найдены")}),e.jsx("p",{className:"mt-2 text-gray-600",children:c?"Мы пока не добавили материалы СМИ. Проверьте позже или предложите публикацию.":a("news.empty.description","Попробуйте изменить поисковый запрос или зайдите позже — мы уже готовим новые публикации.")})]}):e.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 xl:grid-cols-3",children:j.map(t=>e.jsx("article",{className:"group flex h-full flex-col overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-sm transition hover:-translate-y-1 hover:shadow-lg",children:e.jsxs(_,{href:route("news.show",t.slug),className:"block",children:[e.jsxs("div",{className:"relative h-56 overflow-hidden bg-gray-100",children:[t.videoItems&&t.videoItems.length>0?(()=>{const s=t.videoItems[0],o=s.embed_url||s.src||s.url||s.path;return s.is_external&&s.is_embed&&o?e.jsx("iframe",{src:o,title:t.title,className:"h-full w-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0}):e.jsx("video",{src:o,poster:s.thumbnail||void 0,controls:!0,className:"h-full w-full object-cover",children:"Ваш браузер не поддерживает воспроизведение видео."})})():t.galleryImages.length>1?e.jsx(K,{images:t.galleryImages,className:"h-56",height:"224px",showDots:!0,showCounter:!1,autoPlay:!0,interval:4e3}):t.galleryImages.length===1?e.jsx("img",{src:t.galleryImages[0],alt:t.title,className:"h-full w-full object-cover"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center text-gray-300",children:e.jsx("svg",{className:"h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"absolute left-4 top-4 rounded-full bg-white/95 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-gray-700 shadow-sm",children:t.published_at_formatted||"—"})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 transition group-hover:text-blue-600",children:t.title}),t.preparedExcerpt&&e.jsx("p",{className:"flex-1 text-sm leading-relaxed text-gray-600 line-clamp-4",children:t.preparedExcerpt}),e.jsxs("span",{className:"inline-flex items-center text-sm font-semibold text-blue-600",children:[a("news.card.read_more","Читать далее"),e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})},t.id))}),Array.isArray(l==null?void 0:l.links)&&l.links.length>1&&e.jsx("div",{className:"mt-12 flex justify-center",children:e.jsx("nav",{className:"flex flex-wrap items-center gap-2",children:l.links.map((t,s)=>{const o=t.url===null,x=String(t.label||"").replace(/<[^>]+>/g,"").replace(/&laquo;|&raquo;/g,"").trim(),y=x.toLowerCase(),n=["previous","предыдущая","pagination.previous"].includes(y),d=["next","следующая","pagination.next"].includes(y),h=["...","…"].includes(x);return e.jsxs(_,{href:t.url||"#",className:`rounded-full px-4 py-2 text-sm font-medium transition ${t.active?"bg-blue-600 text-white shadow":o?"bg-gray-100 text-gray-400":"bg-white text-gray-700 hover:bg-blue-50"}`,preserveScroll:!0,preserveState:!0,children:[n&&e.jsx("span",{className:"flex items-center justify-center",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),d&&e.jsx("span",{className:"flex items-center justify-center",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),!n&&!d&&!h&&e.jsx("span",{className:"flex items-center justify-center",children:x}),h&&e.jsx("span",{className:"flex items-center justify-center",children:"…"})]},`${t.label}-${s}`)})})})]})}export{ee as default};
