import{r as u,j as e}from"./app-PWNA6cAJ.js";function N({onSelect:o,onClose:c,multiple:d=!1}){const[h,m]=u.useState([]),[a,f]=u.useState(!0),[x,i]=u.useState(null),[n,b]=u.useState([]),[g,j]=u.useState("");u.useEffect(()=>{y()},[]);const y=async()=>{try{f(!0);const r=await fetch("/admin/images/news");if(!r.ok)throw new Error(`Ошибка HTTP: ${r.status}`);const l=await r.json();m(l),i(null)}catch(r){console.error("Ошибка при загрузке изображений:",r),i("Не удалось загрузить изображения. Пожалуйста, попробуйте позже.")}finally{f(!1)}},w=r=>{d?n.some(l=>l.url===r.url)?b(n.filter(l=>l.url!==r.url)):b([...n,r]):b([r])},t=()=>{n.length>0&&o(d?n:n[0]),c()},s=g?h.filter(r=>r.name.toLowerCase().includes(g.toLowerCase())):h;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Библиотека изображений"}),e.jsx("button",{onClick:c,className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Поиск изображений...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:g,onChange:r=>j(r.target.value)})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):x?e.jsx("div",{className:"text-center text-red-500 p-4",children:x}):s.length===0?e.jsx("div",{className:"text-center text-gray-500 p-4",children:g?"Изображения не найдены":"Нет доступных изображений"}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:s.map((r,l)=>e.jsxs("div",{className:`relative border rounded-lg overflow-hidden cursor-pointer transition-all duration-200 ${n.some(p=>p.url===r.url)?"ring-2 ring-blue-500 shadow-lg":"hover:shadow-md"}`,onClick:()=>w(r),children:[e.jsx("img",{src:r.url,alt:r.name,className:"w-full h-32 object-cover"}),n.some(p=>p.url===r.url)&&e.jsx("div",{className:"absolute top-2 right-2 bg-blue-500 rounded-full p-1",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:"p-2 bg-white text-xs truncate",children:r.name})]},l))})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:n.length>0?`Выбрано: ${n.length}`:"Выберите изображения"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:c,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100",children:"Отмена"}),e.jsx("button",{onClick:t,disabled:n.length===0,className:`px-4 py-2 rounded-lg ${n.length>0?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Выбрать"})]})]})]})})}function L({images:o,setImages:c,mainImage:d,setMainImage:h,max:m=18}){const a=u.useRef(),[f,x]=u.useState(!1),i=t=>{t.preventDefault();const s=Array.from(t.dataTransfer.files).filter(r=>r.type.startsWith("image/"));s.length&&b(s)},n=t=>{const s=Array.from(t.target.files).filter(r=>r.type.startsWith("image/"));s.length&&b(s)},b=t=>{const s=t.slice(0,m-o.length);c([...o,...s]),!d&&s.length>0&&h(s[0])},g=t=>{const s=o.filter((r,l)=>l!==t);c(s),d===o[t]&&h(s[0]||null)},j=t=>{h(t)},y=()=>{x(!0)},w=t=>{const l=(Array.isArray(t)?t:[t]).filter(p=>!o.some(v=>typeof v=="string"&&v===p.url)).map(p=>p.url);c([...o,...l]),!d&&l.length>0&&h(l[0])};return e.jsxs("div",{children:[f&&e.jsx(N,{onSelect:w,onClose:()=>x(!1),multiple:!0}),e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Изображения"}),e.jsxs("button",{type:"button",onClick:y,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Выбрать из библиотеки"]})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50 hover:bg-gray-100 transition cursor-pointer mb-4",onDrop:i,onDragOver:t=>t.preventDefault(),onClick:()=>a.current.click(),style:{minHeight:"120px"},children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{className:"h-10 w-10 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsxs("span",{className:"text-blue-600 font-medium cursor-pointer",children:["Перетащите или выберите до ",m," изображений"]}),e.jsx("span",{className:"text-xs text-gray-400",children:"PNG, JPG, GIF, WEBP"})]}),e.jsx("input",{ref:a,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:n})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:o.map((t,s)=>{const r=typeof t=="string"?t:URL.createObjectURL(t);return e.jsxs("div",{className:"relative group border rounded-lg overflow-hidden shadow bg-white",children:[e.jsx("img",{src:r,alt:typeof t=="string"?"Загруженное":t.name,className:"w-full h-32 object-cover"}),e.jsx("button",{type:"button",className:"absolute top-1 right-1 bg-white bg-opacity-80 rounded-full p-1 shadow hover:bg-red-100 transition",title:"Удалить изображение",onClick:l=>{l.stopPropagation(),g(s)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("button",{type:"button",className:`absolute bottom-1 left-1 bg-white bg-opacity-80 rounded-full p-1 shadow hover:bg-yellow-100 transition ${d===t?"ring-2 ring-yellow-400":""}`,title:"Сделать главным",onClick:l=>{l.stopPropagation(),j(t)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:d===t?"gold":"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 17.75L18.2 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.44 4.73L5.8 21z"})})})]},s)})})]})}const C=({value:o="",onChange:c,placeholder:d="Введите текст...",className:h="",minHeight:m="180px"})=>{const a=u.useRef(null),[f,x]=u.useState(!1);u.useEffect(()=>{a.current&&a.current.innerHTML!==o&&(a.current.innerHTML=o)},[o]);const i=(b,g=null)=>{document.execCommand(b,!1,g),a.current&&c&&c(a.current.innerHTML),a.current.focus()},n=()=>{c&&a.current&&c(a.current.innerHTML)};return e.jsxs("div",{className:"simple-editor-container",children:[e.jsxs("div",{className:"simple-editor-toolbar flex gap-1 p-2 border-b border-gray-200 bg-gray-50 rounded-t",children:[e.jsx("button",{type:"button",onClick:()=>i("bold"),className:"p-1 hover:bg-gray-200 rounded",title:"Полужирный",children:e.jsx("strong",{children:"Ж"})}),e.jsx("button",{type:"button",onClick:()=>i("italic"),className:"p-1 hover:bg-gray-200 rounded",title:"Курсив",children:e.jsx("em",{children:"К"})}),e.jsx("button",{type:"button",onClick:()=>i("underline"),className:"p-1 hover:bg-gray-200 rounded",title:"Подчеркнутый",children:e.jsx("u",{children:"Ч"})}),e.jsx("div",{className:"mx-2 border-r border-gray-300"}),e.jsx("button",{type:"button",onClick:()=>i("insertUnorderedList"),className:"p-1 hover:bg-gray-200 rounded",title:"Маркированный список",children:"• Список"}),e.jsx("button",{type:"button",onClick:()=>i("insertOrderedList"),className:"p-1 hover:bg-gray-200 rounded",title:"Нумерованный список",children:"1. Список"}),e.jsx("div",{className:"mx-2 border-r border-gray-300"}),e.jsx("button",{type:"button",onClick:()=>i("formatBlock","h2"),className:"p-1 hover:bg-gray-200 rounded",title:"Заголовок",children:"H2"}),e.jsx("button",{type:"button",onClick:()=>i("formatBlock","h3"),className:"p-1 hover:bg-gray-200 rounded",title:"Подзаголовок",children:"H3"}),e.jsx("button",{type:"button",onClick:()=>i("formatBlock","p"),className:"p-1 hover:bg-gray-200 rounded",title:"Параграф",children:"P"})]}),e.jsx("div",{ref:a,contentEditable:!0,className:`w-full p-3 bg-white border border-gray-300 rounded-b outline-none ${f?"border-blue-400 ring-2 ring-blue-100":""} ${h}`,style:{minHeight:m},onInput:n,onFocus:()=>x(!0),onBlur:()=>x(!1),placeholder:d,"data-placeholder":d,dangerouslySetInnerHTML:{__html:o}}),e.jsx("style",{children:`
        [contenteditable]:empty:before {
          content: attr(data-placeholder);
          color: #9ca3af;
          font-style: italic;
        }
      `})]})};export{L as I,C as S};
