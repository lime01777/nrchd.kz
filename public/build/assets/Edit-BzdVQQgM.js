import{r as g,W as G,j as e,a as H}from"./app-Cg-aiRh8.js";import{A as K}from"./AdminLayout-BBGvqktT.js";import{M as Q,a as V,b as J}from"./MediaManager-IUgHvcJX.js";import"./transition--wkYrX6_.js";import"./use-is-mounted-DKJQzBpD.js";import"./SafeImage-p-xU4kDM.js";import"./SafeVideo-Ct1vMtWD.js";import"./mediaUtils-oRnee45q.js";const j=["–û–±—â–∏–µ","–ê–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏—è","–û–±—É—á–µ–Ω–∏–µ","–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏","–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã","–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è","–§–∏–ª–∏–∞–ª—ã","–ê–Ω–æ–Ω—Å—ã —Å–æ–±—ã—Ç–∏–π"];function X({news:s=null}){const N=!!s,[A,p]=g.useState(!1),{data:r,setData:n,post:O,put:z,processing:E,errors:d}=G({title:(s==null?void 0:s.title)||"",category:Array.isArray(s==null?void 0:s.category)?s.category:s!=null&&s.category?[s.category]:[],content:typeof(s==null?void 0:s.content)=="string"?s.content:"",images:(s==null?void 0:s.images)||[],status:(s==null?void 0:s.status)||"–ß–µ—Ä–Ω–æ–≤–∏–∫",publishDate:(s==null?void 0:s.publishDate)||new Date().toISOString().substr(0,10)});g.useEffect(()=>{s&&console.log("–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏:",{title:s.title,images:s.images,main_image:s.main_image})},[s]);const[h,D]=g.useState(()=>{if(s!=null&&s.category){const t=Array.isArray(s.category)?s.category:[s.category];return Array.from(new Set([...j,...t]))}return j}),[u,f]=g.useState(Array.isArray(r.category)?r.category:r.category?[r.category]:[]),[C,L]=g.useState(""),[v,F]=g.useState(!1),[x,M]=g.useState(r.images||[]),[w,Y]=g.useState(!1);console.log("NewsEdit - –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏:",{news:s,data:r,images:r.images,imagesType:typeof r.images}),g.useEffect(()=>{r.images&&r.images.length>0&&M(r.images)},[]),g.useEffect(()=>{const t=a=>{v&&!a.target.closest(".category-dropdown")&&F(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[v]);const I=t=>{console.log("Edit - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:",t);const a=Array.isArray(t)?t:[];M(a);const o=[],i=[];a.forEach(c=>{c instanceof File?o.push(c):typeof c=="string"&&c.trim().length>0&&i.push(c)}),console.log("Edit - —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ URL:",{files:o,urls:i,totalImages:a.length}),n(c=>({...c,images:i,image_files:o}))},_=(t,a)=>{let o;a?o=[...u,t]:o=u.filter(i=>i!==t),f(o),n("category",o)},U=()=>{const t=C.trim();if(!t){alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏");return}if(h.includes(t)){alert("–¢–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç");return}if(t.length<2){alert("–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞");return}if(t.length>50){alert("–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 50 —Å–∏–º–≤–æ–ª–æ–≤");return}const a=[...h,t];D(a);const o=[...u,t];f(o),n("category",o),L("")},B=t=>{if(!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é "${t}"?`))return;const a=u.filter(i=>i!==t);f(a),n("category",a);const o=h.filter(i=>i!==t);D(o)},R=()=>{f([...h]),n("category",[...h])},q=()=>{f([]),n("category",[])},P=()=>{const t=h.filter(a=>!u.includes(a));f(t),n("category",t)},T=t=>{t.preventDefault(),p(!0);try{const a=r.category||[];if(console.log("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π:",{images:x,data_images:r.images}),!r.title||r.title.trim().length===0){alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫"),p(!1);return}if(Array.isArray(r.category)||n("category",typeof r.category=="string"?[r.category]:[]),typeof r.content!="string"&&n("content",String(r.content||"")),["–ß–µ—Ä–Ω–æ–≤–∏–∫","–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ","–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ"].includes(r.status)||n("status","–ß–µ—Ä–Ω–æ–≤–∏–∫"),!r.content||r.content.replace(/<[^>]*?>/g,"").trim().length<10){alert("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤"),p(!1);return}if(a.length===0){alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é"),p(!1);return}console.log("–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:",{images:x,imagesLength:x?x.length:0,imagesType:typeof x});const o=x.filter(l=>{const m=l&&(typeof l=="string"||l instanceof File&&l.size>0);return m||console.warn("–ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:",l),m});console.log("–í–∞–ª–∏–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:",o);const i=[],c=[],k=[],S=[];o.forEach(l=>{var m;if(l instanceof File)console.log("–î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª:",l.name,l.size),l.type.startsWith("video/")?c.push(l):i.push(l);else if(typeof l=="string"){console.log("–î–æ–±–∞–≤–ª—è–µ–º URL:",l);const y=(m=l.split(".").pop())==null?void 0:m.toLowerCase();["mp4","avi","mov","wmv","flv","webm"].includes(y)?S.push(l):k.push(l)}}),console.log("–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:",{imageFiles:i,videoFiles:c,imageUrls:k,videoUrls:S});const b={title:r.title,content:r.content,status:r.status,publishDate:r.publishDate||"",category:a,images:[...k,...S]};i.length>0&&(b.image_files=i),c.length>0&&(b.video_files=c),console.log("–§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:",b);const W={preserveScroll:!0,forceFormData:i.length>0||c.length>0,onSuccess:l=>{console.log("–£—Å–ø–µ—à–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:",l),p(!1)},onError:l=>{console.error("–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:",l),p(!1);const m=[];Object.keys(l).forEach(y=>{Array.isArray(l[y])?m.push(...l[y]):m.push(l[y])}),m.length>0&&alert(`–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
`+m.join(`
`))},onFinish:()=>{p(!1)}};N?z(route("admin.news.update",s.id),b,W):O(route("admin.news.store"),b,W)}catch(a){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã:",a),p(!1),alert("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã")}},$=t=>{n("content",t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:N?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏":"–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏"}),e.jsxs(H,{href:route("admin.news"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É"]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:e.jsxs("form",{onSubmit:T,className:"min-h-full",children:[e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-6",children:[e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫ *"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"text",name:"title",id:"title",value:r.title,onChange:t=>n("title",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,placeholder:"–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏"})}),d.title&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:d.title})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ *"}),e.jsxs("div",{className:"relative category-dropdown",children:[e.jsxs("button",{type:"button",onClick:()=>F(!v),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-md bg-white text-left text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("span",{className:u.length>0?"text-gray-900":"text-gray-500",children:u.length>0?`–í—ã–±—Ä–∞–Ω–æ: ${u.length} –∫–∞—Ç–µ–≥–æ—Ä–∏–π`:"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..."}),e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),v&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex gap-2 mb-3 pb-2 border-b border-gray-200",children:[e.jsx("button",{type:"button",onClick:R,className:"px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",children:"–í—ã–±—Ä–∞—Ç—å –≤—Å–µ"}),e.jsx("button",{type:"button",onClick:q,className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700",children:"–°–Ω—è—Ç—å –≤—ã–±–æ—Ä"}),e.jsx("button",{type:"button",onClick:P,className:"px-2 py-1 text-xs bg-purple-500 text-white rounded hover:bg-purple-600",children:"–ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"}),e.jsx("div",{className:"space-y-1",children:h.filter(t=>j.includes(t)).map(t=>e.jsxs("label",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.includes(t),onChange:a=>_(t,a.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:t})]}),e.jsx("span",{className:"text-xs text-gray-400 px-2 py-1 bg-gray-100 rounded",children:"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è"})]},t))})]}),h.filter(t=>!j.includes(t)).length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600 mb-2 uppercase tracking-wide",children:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"}),e.jsx("div",{className:"space-y-1",children:h.filter(t=>!j.includes(t)).map(t=>e.jsxs("label",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.includes(t),onChange:a=>_(t,a.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:t})]}),e.jsx("button",{type:"button",onClick:a=>{a.preventDefault(),a.stopPropagation(),B(t)},className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors",title:"–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é",children:e.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},t))})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:C,onChange:t=>L(t.target.value),onKeyPress:t=>{t.key==="Enter"&&(t.preventDefault(),U())},placeholder:"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è",className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{type:"button",onClick:U,disabled:!C.trim()||w,className:"px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:w?"...":"–î–æ–±–∞–≤–∏—Ç—å"})]})})]})})]}),d.category&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:d.category})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"–°—Ç–∞—Ç—É—Å *"}),e.jsx("div",{className:"mt-1",children:e.jsxs("select",{id:"status",name:"status",value:r.status,onChange:t=>n("status",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"–ß–µ—Ä–Ω–æ–≤–∏–∫",children:"–ß–µ—Ä–Ω–æ–≤–∏–∫"}),e.jsx("option",{value:"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ",children:"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ"}),e.jsx("option",{value:"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ",children:"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ"})]})}),d.status&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:d.status})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"publishDate",className:"block text-sm font-medium text-gray-700",children:"–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"date",name:"publishDate",id:"publishDate",value:r.publishDate,onChange:t=>n("publishDate",t.target.value),className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"})}),d.publishDate&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:d.publishDate})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["üé• –ú–µ–¥–∏–∞ –≥–∞–ª–µ—Ä–µ—è",e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"- –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ (–¥–æ 10 —Ñ–∞–π–ª–æ–≤)"})]}),e.jsx(Q,{media:x,setMedia:I,maxFiles:10}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{onSelect:t=>{const a=[...x,t.path];I(a)},selectedMedia:x.map(t=>({path:t})),maxFiles:10})})]}),e.jsxs("div",{className:"sm:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ *"}),e.jsx(J,{value:r.content,onChange:$,placeholder:"–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–æ–≤–æ—Å—Ç–∏...",minHeight:"320px"}),d.content&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:d.content}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"–ú–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤"})]})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:E||A,children:E||A?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":N?"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è":"–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å"})})]})})]})}X.layout=s=>e.jsx(K,{title:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏",children:s});export{X as default};
