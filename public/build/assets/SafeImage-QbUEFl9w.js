import{r as c,j as e}from"./app-BBlvLd4q.js";function y({src:t,alt:x="",className:s="",fallbackSrc:a="/img/placeholder.jpg",onLoad:n,onError:o,...h}){const[m,i]=c.useState(!1),[l,d]=c.useState(!0),f=r=>{d(!1),i(!1),n&&n(r)},g=r=>{if(console.warn("Ошибка загрузки изображения:",t),d(!1),i(!0),o&&o(r),a&&r.target.src!==a)try{r.target.src=a,r.target.onerror=null}catch(j){console.error("Ошибка при загрузке fallback изображения:",j),r.target.style.display="none"}else r.target.style.display="none"},u=t&&typeof t=="string"&&t.trim()!==""&&(t.startsWith("http")||t.startsWith("/"));return t&&typeof t=="string"&&t.startsWith("blob:")?(console.warn("Обнаружен blob URL, показываем fallback:",t),e.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${s}`,children:e.jsxs("div",{className:"text-gray-400 text-center",children:[e.jsx("svg",{className:"w-8 h-8 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-xs",children:"Предварительный просмотр"})]})})):u?e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${s}`,children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}),e.jsx("img",{src:t,alt:x,className:`${s} ${l?"hidden":""} ${m?"opacity-50":""}`,onLoad:f,onError:g,...h})]}):(console.warn("Невалидный src для изображения:",t),e.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${s}`,children:e.jsxs("div",{className:"text-gray-400 text-center",children:[e.jsx("svg",{className:"w-8 h-8 mx-auto mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-xs",children:"Ошибка"})]})}))}export{y as S};
