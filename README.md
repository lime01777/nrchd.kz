# nrchd.kz

Этот сайт разработан для Национального научного центра материнства и детства (ННЦРЗ) с целью предоставления актуальной информации о деятельности центра, его услугах, новостях, научных публикациях и документах. Проект реализован с учетом современных требований к удобству, безопасности и многоязычности.

## О проекте

Сайт nrchd.kz — это современный информационный портал, созданный для пациентов, сотрудников и партнеров ННЦРЗ. Он обеспечивает прозрачность деятельности центра, облегчает доступ к важной информации и способствует развитию научного сообщества.

### Целевая аудитория
- Пациенты и их семьи
- Медицинские специалисты
- Научные сотрудники
- Партнерские организации
- Все заинтересованные в деятельности ННЦРЗ

### Ключевые возможности
- Оперативное размещение новостей и объявлений центра
- Доступ к нормативным и методическим документам
- Представление информации о подразделениях, специалистах и услугах центра
- Публикация научных статей, отчетов и исследований
- Многоязычная поддержка (казахский, русский, английский)
- Интеграция с внутренними сервисами центра
- Адаптивный дизайн для корректной работы на всех устройствах
- Безопасность хранения и передачи данных
- Автоматический перевод контента для удобства пользователей
- Удобная навигация и расширенный поиск по сайту
- **Интеграция с Яндекс.Метрикой для отслеживания посещений**

## Основные разделы сайта

- **Новости** — свежие события, анонсы, достижения центра
- **О центре** — история, миссия, структура, руководство
- **Документы** — нормативные акты, методические рекомендации, внутренние положения
- **Публикации** — научные статьи, отчеты, исследования
- **Контакты** — адрес, телефоны, электронная почта, карта проезда

## Административная панель

Сайт включает в себя полнофункциональную административную панель с возможностями:

- **Управление контентом**: создание, редактирование и удаление новостей, документов
- **Управление пользователями**: регистрация, роли, права доступа
- **Статистика посещений**: интеграция с Яндекс.Метрикой для отслеживания:
  - Количество посетителей за день/неделю/месяц
  - Количество просмотров страниц
  - Средняя продолжительность сессии
- **Система переводов**: автоматический перевод и управление многоязычным контентом
- **Настройки сайта**: конфигурация основных параметров

## Админка новостей: как создать запись

1. Авторизуйтесь под пользователем с ролью `admin` или `editor` (значение хранится в колонке `users.role`).
2. Откройте список нужного раздела: `https://example.com/admin/news` для новостей или `https://example.com/admin/news/media` для материалов СМИ.
3. Для создания записи используйте сегменты пути:
   - Новости: `route('admin.news.create', 'news')` → `https://example.com/admin/news/create/news`.
   - СМИ о нас: `route('admin.news.create', 'media')` → `https://example.com/admin/news/create/media`.
4. Форма автоматически подставляет раздел и отправляет `section=news|media` без query-параметров, поэтому WAF не блокирует запросы.
5. После сохранения вы будете перенаправлены в соответствующий список (`admin/news` или `admin/news/media`).

## Plesk/WAF: почему без ?type=

ModSecurity в Plesk блокировал `GET /admin/news/create?type=media`, трактуя параметр `type` как потенциально опасный. Чтобы исключить ложные срабатывания:

- Раздел передаётся сегментом пути (`/admin/news/create/{section?}`) и жёстко нормализуется на сервере.
- Все ссылки на фронтенде обновлены и используют `route('admin.news.create', 'news'|'media')`; query `?type=` не используется.
- Команда `php artisan news:diagnose` проверяет маршрут, ссылки и наличие ролей `admin|editor`, что позволяет быстро выявить регрессии.


## Технологии

- Backend: PHP
- Frontend: React (через Inertia.js)
- База данных: MySQL
- Email-уведомления, автоматический перевод контента
- Интеграция с API Яндекс.Метрики

## Команды для разработки

```bash
# Очистка кэша метрики
php artisan metrika:clear-cache

# Тестирование подключения к метрике
php test_metrika.php
```

## Преимущества для пользователей и организации
- Быстрый доступ к актуальной информации
- Повышение прозрачности и открытости деятельности центра
- Поддержка научной и образовательной деятельности
- Современный и интуитивно понятный интерфейс
- **Детальная аналитика посещений для принятия решений**

## Автор

Сайт разработан специально для организации ННЦРЗ.

## Лицензия

[MIT](LICENSE)
