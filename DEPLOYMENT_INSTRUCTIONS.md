# Инструкция по развертыванию на хостинге

## Проблема
При развертывании на хостинге могут возникнуть ошибки миграций, если таблицы `translations` и `stored_translations` уже существуют в базе данных.

## Решение

### Вариант 1: Использование специальной команды (рекомендуется)

1. Загрузите код на хостинг
2. Выполните команду для безопасного развертывания:
```bash
php artisan deploy:translations
```

Эта команда:
- ✅ Проверит существование таблиц
- ✅ Создаст недостающие таблицы
- ✅ Отметит все миграции как выполненные
- ✅ Безопасно работает даже если таблицы уже существуют

### Вариант 2: Ручное исправление миграций

Если команда недоступна, исправьте миграции вручную:

1. Откройте файл `database/migrations/2025_08_15_125231_create_translations_table.php`
2. Замените метод `up()` на:
```php
public function up(): void
{
    // Проверяем, существует ли таблица уже
    if (!Schema::hasTable('translations')) {
        Schema::create('translations', function (Blueprint $table) {
            // ... существующий код создания таблицы
        });
    }
}
```

3. Аналогично исправьте `database/migrations/2025_08_15_125236_create_stored_translations_table.php`

### Вариант 3: Использование новой миграции

Используйте новую миграцию `2025_08_17_173456_fix_translations_tables.php`, которая:
- ✅ Безопасно создает таблицы
- ✅ Добавляет недостающие колонки
- ✅ Работает в любых условиях

## Проверка

После выполнения любого из вариантов проверьте статус:
```bash
php artisan migrate:status
```

Все миграции должны быть отмечены как "Ran" (выполненные).

## Структура таблиц

### Таблица `translations`
- `id` - первичный ключ
- `original_text` - исходный текст
- `translated_text` - переведенный текст
- `source_language` - исходный язык (по умолчанию 'ru')
- `target_language` - целевой язык
- `content_type` - тип контента (nullable)
- `content_id` - ID контента (nullable)
- `created_at`, `updated_at` - временные метки

### Таблица `stored_translations`
- `id` - первичный ключ
- `original_text` - исходный текст
- `translated_text` - переведенный текст
- `target_language` - целевой язык
- `page_url` - URL страницы (nullable)
- `hash` - уникальный хеш
- `is_verified` - флаг проверки
- `created_at`, `updated_at` - временные метки

## Примечания

- Все миграции теперь безопасны и не вызовут ошибок при повторном выполнении
- Данные в существующих таблицах сохранятся
- Индексы создаются автоматически для оптимизации производительности
