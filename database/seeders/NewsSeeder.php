<?php

namespace Database\Seeders;

use App\Models\News;
use App\Models\User;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;
use Carbon\Carbon;

/**
 * Сидер для создания тестовых новостей
 * Создает несколько записей с реальными датами июля 2025 года
 */
class NewsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Получаем первого пользователя или создаем тестового
        $user = User::first() ?? User::factory()->create(['role' => 'admin']);

        $newsItems = [
            [
                'title' => 'Новый метод лечения сердечно-сосудистых заболеваний представлен в Национальном центре',
                'excerpt' => 'В Национальном центре кардиологии представили инновационный метод лечения сердечно-сосудистых заболеваний.',
                'body' => '<p>В Национальном центре кардиологии представили инновационный метод лечения сердечно-сосудистых заболеваний, который позволяет снизить риск осложнений на 40%.</p><p>Метод основан на использовании новых биомаркеров и персонализированного подхода к лечению. Первые клинические испытания показали высокую эффективность.</p>',
                'cover_image_path' => 'news/2025/07/placeholder-1.jpg',
                'cover_image_thumb_path' => 'news/2025/07/placeholder-1_thumb.jpg',
                'cover_image_alt' => 'Новый метод лечения сердечно-сосудистых заболеваний',
                'seo_title' => 'Новый метод лечения сердечно-сосудистых заболеваний | ННЦРЗ',
                'seo_description' => 'Инновационный метод лечения сердечно-сосудистых заболеваний с использованием новых биомаркеров.',
                'status' => 'published',
                'published_at' => Carbon::create(2025, 7, 2, 10, 0, 0),
            ],
            [
                'title' => 'Открыт новый медицинский центр с современным оборудованием',
                'excerpt' => 'В столице открылся новый многопрофильный медицинский центр, оснащенный самым современным диагностическим и лечебным оборудованием.',
                'body' => '<p>В столице открылся новый многопрофильный медицинский центр, оснащенный самым современным диагностическим и лечебным оборудованием.</p><p>Центр специализируется на кардиологии, онкологии, неврологии и ортопедии, и предлагает пациентам комплексный подход к диагностике и лечению.</p>',
                'cover_image_path' => 'news/2025/07/placeholder-2.jpg',
                'cover_image_thumb_path' => 'news/2025/07/placeholder-2_thumb.jpg',
                'cover_image_alt' => 'Новый медицинский центр',
                'seo_title' => 'Открыт новый медицинский центр | ННЦРЗ',
                'seo_description' => 'Новый многопрофильный медицинский центр с современным оборудованием открыт в столице.',
                'status' => 'published',
                'published_at' => Carbon::create(2025, 7, 5, 14, 0, 0),
            ],
            [
                'title' => 'Ученые разработали новый метод ранней диагностики рака',
                'excerpt' => 'Группа ученых из Национального центра биомедицинских исследований разработала новый метод ранней диагностики онкологических заболеваний.',
                'body' => '<p>Группа ученых из Национального центра биомедицинских исследований разработала новый метод ранней диагностики онкологических заболеваний на основе анализа циркулирующей опухолевой ДНК в крови.</p><p>Метод позволяет выявлять наличие злокачественных новообразований на ранних стадиях, когда традиционные методы диагностики еще неэффективны.</p>',
                'cover_image_path' => 'news/2025/07/placeholder-3.jpg',
                'cover_image_thumb_path' => 'news/2025/07/placeholder-3_thumb.jpg',
                'cover_image_alt' => 'Новый метод диагностики рака',
                'seo_title' => 'Новый метод ранней диагностики рака | ННЦРЗ',
                'seo_description' => 'Ученые разработали инновационный метод ранней диагностики онкологических заболеваний.',
                'status' => 'published',
                'published_at' => Carbon::create(2025, 7, 10, 9, 30, 0),
            ],
            [
                'title' => 'Запущена национальная программа по борьбе с сердечно-сосудистыми заболеваниями',
                'excerpt' => 'Правительство запустило национальную программу по борьбе с сердечно-сосудистыми заболеваниями.',
                'body' => '<p>Правительство запустило национальную программу по борьбе с сердечно-сосудистыми заболеваниями, которая включает в себя комплекс мер по профилактике, ранней диагностике и лечению.</p><p>Программа предусматривает создание сети кардиологических центров, оснащенных современным оборудованием, подготовку специалистов и проведение массовых скрининговых обследований населения.</p>',
                'cover_image_path' => 'news/2025/07/placeholder-4.jpg',
                'cover_image_thumb_path' => 'news/2025/07/placeholder-4_thumb.jpg',
                'cover_image_alt' => 'Национальная программа по борьбе с сердечно-сосудистыми заболеваниями',
                'seo_title' => 'Национальная программа по борьбе с ССЗ | ННЦРЗ',
                'seo_description' => 'Запущена комплексная программа по профилактике и лечению сердечно-сосудистых заболеваний.',
                'status' => 'published',
                'published_at' => Carbon::create(2025, 7, 15, 11, 0, 0),
            ],
            [
                'title' => 'Медицинский университет открыл новую программу подготовки специалистов телемедицины',
                'excerpt' => 'Ведущий медицинский университет объявил о запуске новой образовательной программы по подготовке специалистов в области телемедицины.',
                'body' => '<p>Ведущий медицинский университет объявил о запуске новой образовательной программы по подготовке специалистов в области телемедицины.</p><p>Программа разработана в сотрудничестве с ведущими IT-компаниями и направлена на формирование у врачей компетенций, необходимых для оказания медицинской помощи с использованием телемедицинских технологий.</p>',
                'cover_image_path' => 'news/2025/07/placeholder-5.jpg',
                'cover_image_thumb_path' => 'news/2025/07/placeholder-5_thumb.jpg',
                'cover_image_alt' => 'Программа подготовки специалистов телемедицины',
                'seo_title' => 'Новая программа подготовки специалистов телемедицины | ННЦРЗ',
                'seo_description' => 'Медицинский университет открыл программу подготовки специалистов в области телемедицины.',
                'status' => 'published',
                'published_at' => Carbon::create(2025, 7, 20, 15, 0, 0),
            ],
        ];

        foreach ($newsItems as $item) {
            News::create([
                'title' => $item['title'],
                'slug' => Str::slug($item['title']),
                'excerpt' => $item['excerpt'],
                'body' => $item['body'],
                'cover_image_path' => $item['cover_image_path'],
                'cover_image_thumb_path' => $item['cover_image_thumb_path'],
                'cover_image_alt' => $item['cover_image_alt'],
                'seo_title' => $item['seo_title'],
                'seo_description' => $item['seo_description'],
                'status' => $item['status'],
                'published_at' => $item['published_at'],
                'created_by' => $user->id,
            ]);
        }
    }
}
